(window.webpackJsonp=window.webpackJsonp||[]).push([[288],{622:function(s,n,a){"use strict";a.r(n);var e=a(2),t=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"mysql-存储过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql-存储过程"}},[s._v("#")]),s._v(" MySQL 存储过程")]),s._v(" "),n("p",[s._v("存储过程（Stored Procedure）是在大型数据库系统中，一组为了完成特定功能的SQL 语句集，它存储在数据库中，一次编译后永久有效，用户通过指定存储过程的名字并给出参数（如果该存储过程带有参数）来执行它。存储过程是数据库中的一个重要对象。在数据量特别庞大的情况下利用存储过程能达到倍速的效率提升")]),s._v(" "),n("h2",{attrs:{id:"一、存储过程概述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、存储过程概述"}},[s._v("#")]),s._v(" 一、存储过程概述")]),s._v(" "),n("h3",{attrs:{id:"_1-1、什么是存储过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、什么是存储过程"}},[s._v("#")]),s._v(" 1.1、什么是存储过程")]),s._v(" "),n("p",[s._v("存储过程是数据库中的一个重要对象。")]),s._v(" "),n("p",[s._v("存储过程是在数据库系统中，一组为了完成特定功能的SQL 语句集。存储过程是存储在数据库中，一次编译后，到处运行。不需要再次编译，用户通过指定存储过程的名字并传递参数（如果该存储过程带有参数）来执行。")]),s._v(" "),n("h3",{attrs:{id:"_1-2、存储过程特点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、存储过程特点"}},[s._v("#")]),s._v(" 1.2、存储过程特点")]),s._v(" "),n("p",[s._v("用来完成较复杂业务\n比较灵活，易修改，好编写，可编程性强\n编写好的存储过程可重复使用")]),s._v(" "),n("h3",{attrs:{id:"_1-3、存储过程优缺点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3、存储过程优缺点"}},[s._v("#")]),s._v(" 1.3、存储过程优缺点")]),s._v(" "),n("p",[n("strong",[s._v("优点")])]),s._v(" "),n("p",[s._v("存储过程在创建的时候直接编译，sql语句每次使用都要编译，效率高。")]),s._v(" "),n("p",[s._v("存储过程可以被重复使用。")]),s._v(" "),n("p",[s._v("存储过程只连接一次数据库，sql语句在访问多张表时，连接多次数据库。")]),s._v(" "),n("p",[s._v("存储的程序是安全的。存储过程的应用程序授予适当的权限。\n"),n("strong",[s._v("缺点")]),s._v("\n在那里创建的存储过程，就只能在那里使用，可移植性差。")]),s._v(" "),n("p",[s._v("开发存储过程时，标准不定好的话，后期维护麻烦。")]),s._v(" "),n("p",[s._v("没有具体的编辑器，开发和调试都不方便。")]),s._v(" "),n("p",[s._v("太复杂的业务逻辑，存储过程也解决不了。")]),s._v(" "),n("h2",{attrs:{id:"二、存储过程创建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、存储过程创建"}},[s._v("#")]),s._v(" 二、存储过程创建")]),s._v(" "),n("h3",{attrs:{id:"_2-1、创建格式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、创建格式"}},[s._v("#")]),s._v(" 2.1、创建格式")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\ncreate procedure 过程名()\nbegin\n......\nend;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("查看员工与部门表中的全信息")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure dept_emp()\nbegin\n\tselect * from dept;\n\tselect * from emp;\nend;\n\nmysql> call dept_emp();\n+----+-----------+\n| id | name      |\n+----+-----------+\n| 1  | 研发部 |\n| 2  | 渠道部 |\n| 3  | 教务部 |\n| 4  | 执行部 |\n+----+-----------+\n4 行于数据集 (0.02 秒)\n\n+----+--------+--------+--------+------------+---------+\n| id | name   | gender | salary | join_date  | dept_id |\n+----+--------+--------+--------+------------+---------+\n| 1  | 张三 | 男    | 7200   | 2013-02-24 | 1       |\n| 2  | 李四 | 男    | 3600   | 2010-12-02 | 2       |\n| 3  | 王五 | 男    | 9000   | 2008-08-08 | 2       |\n| 4  | 赵六 | 女    | 5000   | 2015-10-07 | 3       |\n| 5  | 吴七 | 女    | 4500   | 2011-03-14 | 1       |\n| 6  | 王一 | 男    | 8768   | 2013-12-05 | NULL    |\n| 7  | 王二 | 女    | NULL   | NULL       | NULL    |\n+----+--------+--------+--------+------------+---------+\n7 行于数据集 (0.05 秒)\n\nQuery OK, 0 rows affected (0.05 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br")])]),n("h3",{attrs:{id:"_2-2、变量"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、变量"}},[s._v("#")]),s._v(" 2.2、变量")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\ndeclare 变量名 变量类型 default 默认值; #声明变量\nset 变量名=值; #变量赋值\nselect 字段名 into 变量名 from 数据库表; #查询表中字段，完成变量赋值\nselect 变量名; #显示变量\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("查看员工表中id=1的员工的姓名")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure emp_name()\nbegin\n\tdeclare ename varchar(20) default '';\n\tselect name into ename from emp where id=1;\n\tselect ename;\nend;\n\nmysql> call emp_name();\n+--------+\n| ename  |\n+--------+\n| 张三 |\n+--------+\n1 行于数据集 (0.01 秒)\n\nQuery OK, 0 rows affected (0.01 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h3",{attrs:{id:"_2-3、变量作用域"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、变量作用域"}},[s._v("#")]),s._v(" 2.3、变量作用域")]),s._v(" "),n("p",[s._v("存储过程中变量是有作用域的，作用范围在begin和end块之间，end结束变量的作用范围即结束。")]),s._v(" "),n("p",[s._v("变量可分为：")]),s._v(" "),n("p",[n("strong",[s._v("局部变量：")]),s._v(" begin和end块之间")]),s._v(" "),n("p",[n("strong",[s._v("全局变量：")]),s._v(" 放在所有代码块之前；传参变量是全局的，可以在多个块之间起作用")]),s._v(" "),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("查看员工的人数与部门表中的部门数，并找出最高和最低工资（局部变量）")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure dept_or_emp()\nbegin\n\tbegin\n\t\tdeclare e_n int default 0;\n\t\tdeclare d_n int default 0;\n\t\tselect count(*) into e_n from emp;\n\t\tselect count(*) into d_n from dept;\n\t\tselect e_n,d_n;\n\tend;\n\tbegin\n\t\tdeclare max_s double default 0;\n\t\tdeclare min_s double default 0;\n\t\tselect max(salary) into max_s from emp;\n\t\tselect min(salary) into min_s from emp;\n\t\tselect max_s,min_s;\n\tend;\nend;\n\nmysql> call dept_or_emp();\n+------+------+\n| e_n  | d_n  |\n+------+------+\n| 7    | 4    |\n+------+------+\n1 行于数据集 (0.26 秒)\n\n+-------+-------+\n| max_s | min_s |\n+-------+-------+\n| 9000  | 3600  |\n+-------+-------+\n1 行于数据集 (0.26 秒)\n\nQuery OK, 0 rows affected (0.26 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br")])]),n("p",[s._v("查看员工的人数与部门表中的部门数，并找出最高和最低工资（全局变量）")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure dept_or_emp1()\nbegin\n\tdeclare e_n int default 0;\n\tdeclare d_n int default 0;\n\tdeclare max_s double default 0;\n\tdeclare min_s double default 0;\n\tbegin\n\t\tselect count(*) into e_n from emp;\n\t\tselect count(*) into d_n from dept;\n\tend;\n\tbegin\n\n\t\tselect max(salary) into max_s from emp;\n\t\tselect min(salary) into min_s from emp;\n\tend;\n\tselect e_n,d_n,max_s,min_s;\nend;\n\nmysql> call dept_or_emp1();\n+------+------+\n| e_n  | d_n  |\n+------+------+\n| 7    | 4    |\n+------+------+\n1 行于数据集 (0.22 秒)\n\n+-------+-------+\n| max_s | min_s |\n+-------+-------+\n| 9000  | 3600  |\n+-------+-------+\n1 行于数据集 (0.23 秒)\n\nQuery OK, 0 rows affected (0.23 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br")])]),n("h2",{attrs:{id:"三、存储过程参数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、存储过程参数"}},[s._v("#")]),s._v(" 三、存储过程参数")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\ncreate procedure 过程名([IN|OUT|INOUT] 参数名 参数数据类型 )\nbegin\n......\nend;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("strong",[s._v("注意：")])]),s._v(" "),n("p",[s._v("in：传入参数")]),s._v(" "),n("p",[s._v("out：传出参数")]),s._v(" "),n("p",[s._v("inout：可以传入也可以传出")]),s._v(" "),n("h3",{attrs:{id:"_3-1、in"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1、in"}},[s._v("#")]),s._v(" 3.1、in")]),s._v(" "),n("p",[s._v("表示该参数的值必须在调用存储过程事指定，如果不显示指定为in,那么默认就是in类型。")]),s._v(" "),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("根据传入的id查看员工的姓名。")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure emp_id(eid int)\nbegin\n\tdeclare ename varchar(20) default '';\n\tselect name into ename from emp where id=eid;\n\tselect ename;\nend;\n\nmysql> call emp_id(1);\n+--------+\n| ename  |\n+--------+\n| 张三 |\n+--------+\n1 行于数据集 (0.01 秒)\n\nQuery OK, 0 rows affected (0.01 秒)\n\nmysql> call emp_id(2);\n+--------+\n| ename  |\n+--------+\n| 李四 |\n+--------+\n1 行于数据集 (0.01 秒)\n\nQuery OK, 0 rows affected (0.02 秒)\n\nmysql> call emp_id(9);\n+-------+\n| ename |\n+-------+\n|       |\n+-------+\n1 行于数据集 (0.01 秒)\n\nQuery OK, 0 rows affected (0.01 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br")])]),n("h3",{attrs:{id:"_3-2、out"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2、out"}},[s._v("#")]),s._v(" 3.2、out")]),s._v(" "),n("p",[s._v("out参数也需要指定，但必须是变量，不能是常量。")]),s._v(" "),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("根据传入的id，返回员工的姓名。")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure emp_id1(eid int,out ename varchar(20))\nbegin\n\tselect name into ename from emp where id=eid;\nend;\n\nmysql> set @ename='';\nQuery OK, 0 rows affected (0.02 秒)\n\nmysql> call emp_id1(3,@ename);\nQuery OK, 1 rows affected, 1 warnings (0.02 秒)\n\nmysql> select @ename;\n+--------+\n| @ename |\n+--------+\n| 王五 |\n+--------+\n1 行于数据集 (0.02 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("h3",{attrs:{id:"_3-3、inout"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3、inout"}},[s._v("#")]),s._v(" 3.3、inout")]),s._v(" "),n("p",[s._v("如果既需要传入，同时又需要传出，则可以使用INOUT类型参数")]),s._v(" "),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("根据传入的id，返回员工的id和姓名。")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure emp_id2(inout eid int,out ename varchar(20))\nbegin\n\tselect id,name into eid,ename from emp where id=eid;\nend;\n\nmysql> set @eid=3;\nQuery OK, 0 rows affected (0.01 秒)\n\nmysql> set @ename='';\nQuery OK, 0 rows affected (0.01 秒)\n\nmysql> call emp_id2(@eid,@ename);\nQuery OK, 1 rows affected (0.01 秒)\n\nmysql> select @eid,@ename;\n+------+--------+\n| @eid | @ename |\n+------+--------+\n| 3    | 王五 |\n+------+--------+\n1 行于数据集 (0.01 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("h2",{attrs:{id:"四、存储过程条件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#四、存储过程条件"}},[s._v("#")]),s._v(" 四、存储过程条件")]),s._v(" "),n("h3",{attrs:{id:"_4-1、if-else-end-if"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1、if-else-end-if"}},[s._v("#")]),s._v(" 4.1、if…else…end if")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\nif()\nthen\n...\nelse\n...\nend if;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("输入一个id，判断他是否是偶数，偶数打印对应的姓名，奇数打印id")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure emp_if_id(eid int)\nbegin\n\tdeclare ename varchar(20) default '';\n\tif(eid%2=0)\n\tthen\n\t\tselect name into ename from emp where id=eid;\n\t\tselect ename;\n  else\n  \tselect eid;\n  end if;\nend;\n\nmysql> call emp_if_id(2);\n+--------+\n| ename  |\n+--------+\n| 李四 |\n+--------+\n1 行于数据集 (0.02 秒)\n\nQuery OK, 0 rows affected (0.02 秒)\n\nmysql> call emp_if_id(1);\n+------+\n| eid  |\n+------+\n| 1    |\n+------+\n1 行于数据集 (0.01 秒)\n\nQuery OK, 0 rows affected (0.01 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br")])]),n("h3",{attrs:{id:"_4-2、if-elseif-else-endif"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2、if-elseif-else-endif"}},[s._v("#")]),s._v(" 4.2、if…elseif…else…endif")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\nif()\nthen\n...\nelseif()\nthen\n...\nelse\n...\nend if;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("给id为1，2，3的员工加薪1000元，其他员工不变")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure emp_if_salary(eid int)\nbegin\n\tdeclare esalary double default 0;\n\tif(eid=1)\n\tthen\n\t\tupdate emp set salary=salary+1000 where id=eid;\n  elseif(eid=2)\n  then\n  \tupdate emp set salary=salary+1000 where id=eid;\n  elseif(eid=3)\n  then\n  \tupdate emp set salary=salary+1000 where id=eid;\t\n  else\n  \tupdate emp set salary=salary where id=eid;\t\n  end if;\n  select salary into esalary from emp where id=eid;\n  select esalary;\nend;\n\nmysql> call emp_if_salary(1);\n+---------+\n| esalary |\n+---------+\n| 8200    |\n+---------+\n1 行于数据集 (0.03 秒)\n\nQuery OK, 0 rows affected (0.05 秒)\n\nmysql> call emp_if_salary(3);\n+---------+\n| esalary |\n+---------+\n| 10000   |\n+---------+\n1 行于数据集 (0.02 秒)\n\nQuery OK, 0 rows affected (0.02 秒)\n\nmysql> call emp_if_salary(9);\n+---------+\n| esalary |\n+---------+\n| 0       |\n+---------+\n1 行于数据集 (0.02 秒)\n\nQuery OK, 0 rows affected (0.02 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br")])]),n("h3",{attrs:{id:"_4-3、case"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-3、case"}},[s._v("#")]),s._v(" 4.3、case")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\ncase()\nwhen... then...\nwhen... then...\nelse...\nend case;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("给id为1，2，3的员工加薪1000元，其他员工不变")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure emp_case_salary(eid int)\nbegin\n\tdeclare esalary double default 0;\n\tcase (eid)\n\twhen 1 then update emp set salary=salary+1000 where id=eid;\n  when 2 then update emp set salary=salary+1000 where id=eid;\n  when 3 then update emp set salary=salary+1000 where id=eid;\t\n  else\n  \tupdate emp set salary=salary where id=eid;\t\n  end case;\n  select salary into esalary from emp where id=eid;\n  select esalary;\nend;\n\nmysql> call emp_case_salary(3);\n+---------+\n| esalary |\n+---------+\n| 12000   |\n+---------+\n1 行于数据集 (0.02 秒)\n\nQuery OK, 0 rows affected (0.02 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("h2",{attrs:{id:"五、存储过程循环"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#五、存储过程循环"}},[s._v("#")]),s._v(" 五、存储过程循环")]),s._v(" "),n("h3",{attrs:{id:"_5-1、while"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1、while"}},[s._v("#")]),s._v(" 5.1、while")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\nwhile(表达式) do \n......  \nend while;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("通过id查询出员工表中的前5个员工的姓名")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure emp_view()\nbegin\n\tdeclare eid int default 1;\n\tdeclare ename varchar(20) default '';\n\twhile(eid<=5) do\n\t\tselect name into ename from emp where id=eid;\t\n\t\tselect ename;\n\t\tset eid=eid+1;\n\tend while;\t\nend;\n\nmysql> call emp_view();\n+--------+\n| ename  |\n+--------+\n| 张三 |\n+--------+\n1 行于数据集 (0.01 秒)\n\n+--------+\n| ename  |\n+--------+\n| 李四 |\n+--------+\n1 行于数据集 (0.01 秒)\n\n+--------+\n| ename  |\n+--------+\n| 王五 |\n+--------+\n1 行于数据集 (0.02 秒)\n\n+--------+\n| ename  |\n+--------+\n| 赵六 |\n+--------+\n1 行于数据集 (0.02 秒)\n\n+--------+\n| ename  |\n+--------+\n| 吴七 |\n+--------+\n1 行于数据集 (0.03 秒)\n\nQuery OK, 0 rows affected (0.03 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br")])]),n("h3",{attrs:{id:"_5-2、repeat"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2、repeat"}},[s._v("#")]),s._v(" 5.2、repeat")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\nrepeat\n...\nuntil 条件 -- 条件成立，跳出循环\n....\nend repeat;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("通过id查询出员工表中的前5个员工的姓名")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure emp_view1()\nbegin\n\tdeclare eid int default 1;\n\tdeclare ename varchar(20) default '';\n\trepeat\n\t\tselect name into ename from emp where id=eid;\t\t\n\t\tselect ename;\n\t\tset eid=eid+1;\n\tuntil eid>5\n\tend repeat;\t\nend;\n\nmysql> call emp_view1();\n+--------+\n| ename  |\n+--------+\n| 张三 |\n+--------+\n1 行于数据集 (0.02 秒)\n\n+--------+\n| ename  |\n+--------+\n| 李四 |\n+--------+\n1 行于数据集 (0.03 秒)\n\n+--------+\n| ename  |\n+--------+\n| 王五 |\n+--------+\n1 行于数据集 (0.05 秒)\n\n+--------+\n| ename  |\n+--------+\n| 赵六 |\n+--------+\n1 行于数据集 (0.06 秒)\n\n+--------+\n| ename  |\n+--------+\n| 吴七 |\n+--------+\n1 行于数据集 (0.06 秒)\n\nQuery OK, 0 rows affected (0.06 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br")])]),n("h2",{attrs:{id:"六、存储过程游标"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#六、存储过程游标"}},[s._v("#")]),s._v(" 六、存储过程游标")]),s._v(" "),n("p",[s._v("游标是保存查询结果的临时区域")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\ndeclare 游标名 cursor for SQL语句; #声明游标\nopen 游标名; #打开游标\nfetch 游标名 into 变量名; #取出游标的值\nclose 游标名; #关闭游标\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("输出员工表中的id和姓名")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure emp_all_view()\nbegin\n\tdeclare eid int default 1;\n\tdeclare ename varchar(20) default '';\n\tdeclare c_emp cursor for select id,name from emp;\n\topen c_emp;\n\tfetch c_emp into eid,ename;\n\tselect eid,ename;\n\tclose c_emp;\nend;\n\nmysql> call emp_all_view();\n+------+--------+\n| eid  | ename  |\n+------+--------+\n| 1    | 张三 |\n+------+--------+\n1 行于数据集 (0.03 秒)\n\nQuery OK, 0 rows affected (0.03 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("p",[s._v("这样我们只取出了一条信息，这个时候我们需要循环？")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create procedure emp_all_view1()\nbegin\n\tdeclare eid int default 1;\n\tdeclare ename varchar(20) default '';\n\tdeclare c_emp cursor for select id,name from emp;\n\t\n\topen c_emp;\n\tloop\n\t\tfetch c_emp into eid,ename;\n\t\tselect eid,ename;\n\tend loop;\n\tclose c_emp;\nend;\n\nmysql> call emp_all_view1();\n+------+--------+\n| eid  | ename  |\n+------+--------+\n| 1    | 张三 |\n+------+--------+\n1 行于数据集 (0.01 秒)\n\n+------+--------+\n| eid  | ename  |\n+------+--------+\n| 2    | 李四 |\n+------+--------+\n1 行于数据集 (0.02 秒)\n\n+------+--------+\n| eid  | ename  |\n+------+--------+\n| 3    | 王五 |\n+------+--------+\n1 行于数据集 (0.03 秒)\n\n+------+--------+\n| eid  | ename  |\n+------+--------+\n| 4    | 赵六 |\n+------+--------+\n1 行于数据集 (0.03 秒)\n\n+------+--------+\n| eid  | ename  |\n+------+--------+\n| 5    | 吴七 |\n+------+--------+\n1 行于数据集 (0.03 秒)\n\n+------+--------+\n| eid  | ename  |\n+------+--------+\n| 6    | 王一 |\n+------+--------+\n1 行于数据集 (0.04 秒)\n\n+------+--------+\n| eid  | ename  |\n+------+--------+\n| 7    | 王二 |\n+------+--------+\n1 行于数据集 (0.05 秒)\n\nNo data - zero rows fetched, selected, or processed\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br")])]),n("h2",{attrs:{id:"七、存储过程操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#七、存储过程操作"}},[s._v("#")]),s._v(" 七、存储过程操作")]),s._v(" "),n("h3",{attrs:{id:"_7-1、存储过程查看"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-1、存储过程查看"}},[s._v("#")]),s._v(" 7.1、存储过程查看")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\nshow procedure status [like '%字符串%'];\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("案例：")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> show procedure status;\nmysql>show procedure status like '%emp%';\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://www.zutuanxue.com:8000/static/media/images/2020/10/24/1603520873279.png",alt:"image20200221144121604.png"}})]),s._v(" "),n("h3",{attrs:{id:"_7-2、存储过程删除"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-2、存储过程删除"}},[s._v("#")]),s._v(" 7.2、存储过程删除")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\ndrop procedure 存储过程名;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> drop procedure emp_id;\nQuery OK, 0 rows affected (0.02 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"八、自定义函数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#八、自定义函数"}},[s._v("#")]),s._v(" 八、自定义函数")]),s._v(" "),n("h3",{attrs:{id:"_8-1、自定义函数创建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-1、自定义函数创建"}},[s._v("#")]),s._v(" 8.1、自定义函数创建")]),s._v(" "),n("p",[s._v("函数与存储过程最大的区别是函数必须有返回值，否则会报错")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\ncreate function 函数名(参数) returns 返回类型\nbegin\n.....\nreturn 返回值;\nend;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("通过输入的id获取员工的姓名")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create function getName(eid int) returns varchar(20)\nbegin\n\tdeclare ename varchar(20) default '';\n\tselect name into ename from emp where id=eid;\n\treturn ename;\nend;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://www.zutuanxue.com:8000/static/media/images/2020/10/24/1603521032491.png",alt:"image20200221152753864.png"}})]),s._v(" "),n("p",[n("strong",[s._v("注意：")])]),s._v(" "),n("p",[s._v("这是我们开启了bin-log, 我们就必须指定我们的函数指定一个参数deterministic 不确定的\nno sql 没有SQL语句，当然也不会修改数据\nreads sql data 只是读取数据，当然也不会修改数据\nmodifies sql data 要修改数据\ncontains sql 包含了SQL语句")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create function getName(eid int) returns varchar(20) reads sql data\nbegin\n\tdeclare ename varchar(20) default '';\n\tselect name into ename from emp where id=eid;\n\treturn ename;\nend;\n\nmysql> select getName(1);\n+------------+\n| getName(1) |\n+------------+\n| 张三     |\n+------------+\n1 行于数据集 (0.02 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h3",{attrs:{id:"_8-2、自定义函数操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-2、自定义函数操作"}},[s._v("#")]),s._v(" 8.2、自定义函数操作")]),s._v(" "),n("h4",{attrs:{id:"_8-2-1、自定义函数查询"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-1、自定义函数查询"}},[s._v("#")]),s._v(" 8.2.1、自定义函数查询")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\nshow function status [like '%字符串%'];\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> show function status；\nmysql> show function status like '%getName%';\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://www.zutuanxue.com:8000/static/media/images/2020/10/24/1603521094762.png",alt:"image20200221154839122.png"}})]),s._v(" "),n("h4",{attrs:{id:"_8-2-2、自定义函数删除"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-2、自定义函数删除"}},[s._v("#")]),s._v(" 8.2.2、自定义函数删除")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\ndrop function 函数名;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> drop function getName;\nQuery OK, 0 rows affected (0.03 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"九、触发器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#九、触发器"}},[s._v("#")]),s._v(" 九、触发器")]),s._v(" "),n("p",[s._v("触发器与函数、存储过程一样，触发器是一种对象，它能根据对表的操作时间，触发一些动作，这些动作可以是insert,update,delete等操作。")]),s._v(" "),n("h3",{attrs:{id:"_9-1、触发器创建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-1、触发器创建"}},[s._v("#")]),s._v(" 9.1、触发器创建")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create trigger 触发器名字 触发时间 触发事件 on 表 for each row\nbegin\n    -- 触发器内容主体，每行用分号结尾\nend\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[n("strong",[s._v("注意：")])]),s._v(" "),n("p",[n("strong",[s._v("触发时间：")])]),s._v(" "),n("p",[s._v("当 SQL 指令发生时，会令行中数据发生变化，而每张表中对应的行有两种状态："),n("strong",[s._v("数据操作前和操作后")])]),s._v(" "),n("p",[s._v("before：表中数据发生改变前的状态")]),s._v(" "),n("p",[s._v("after：表中数据发生改变后的状态")]),s._v(" "),n("p",[n("strong",[s._v("触发事件：")])]),s._v(" "),n("p",[s._v("触发器是针对数据发送改变才会被触发，对应的操作只有insert、update、delete")]),s._v(" "),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("向员工表中插入数据时，记录插入的id，动作，时间")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("#创建一个操作表\ncreate table emp_log(\n\tid int primary key auto_increment,\n  eid int,\n  eaction varchar(20),\n  etime datetime\n);\n\nmysql> select * from emp_log;\n空的数据集 (0.01 秒)\n\n#创建触发器\ncreate trigger emp_insert after insert on emp for each row\nbegin\n\tinsert into emp_log values(null,NEW.id,'insert',now());\nend;\n\nmysql> insert into emp(id,name,gender)values(8,'王三','男');\nQuery OK, 1 rows affected (0.01 秒)\n\nmysql> select * from emp_log;\n+----+------+---------+---------------------+\n| id | eid  | eaction | etime               |\n+----+------+---------+---------------------+\n| 1  | 8    | insert  | 2020-02-21 03:12:44 |\n+----+------+---------+---------------------+\n1 行于数据集 (0.02 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("h3",{attrs:{id:"_9-2、触发器操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-2、触发器操作"}},[s._v("#")]),s._v(" 9.2、触发器操作")]),s._v(" "),n("h4",{attrs:{id:"_9-2-1、触发器查看"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-1、触发器查看"}},[s._v("#")]),s._v(" 9.2.1、触发器查看")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\nshow triggers [like '%字符串%'];\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> show triggers;\nmysql> show triggers like '%emp%';\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://www.zutuanxue.com:8000/static/media/images/2020/10/24/1603521169582.png",alt:"image20200221161653246.png"}})]),s._v(" "),n("h4",{attrs:{id:"_9-2-2、触发器删除"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-2、触发器删除"}},[s._v("#")]),s._v(" 9.2.2、触发器删除")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\ndrop trigger 触发器名;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> drop trigger emp_insert;\nQuery OK, 0 rows affected (0.02 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"十、事件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#十、事件"}},[s._v("#")]),s._v(" 十、事件")]),s._v(" "),n("p",[s._v("事件取代了原先只能由操作系统的计划任务来执行的工作，而且MySQL的事件调度器可以精确到每秒钟执行一个任务，而操作系统的计划任务只能精确到每分钟执行一次。")]),s._v(" "),n("h3",{attrs:{id:"_10-1、事件创建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10-1、事件创建"}},[s._v("#")]),s._v(" 10.1、事件创建")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\ncreate event[IF NOT EXISTS] event_name -- 创建事件\non schedule 时间和频率 -- on schedule 什么时候来执行\n[on completion [NOT] preserve] -- 调度计划执行完成后是否还保留\n[enable | disable] -- 是否开启事件，默认开启\n[comment '事件描述'] -- 事件的注释\ndo event_body;-- 需要执行的SQL\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[n("strong",[s._v("注意：")])]),s._v(" "),n("p",[n("strong",[s._v("单次计划任务示例")]),s._v("\n在2019年2月1日4点执行一次 on schedule at ‘2019-02-01 04:00:00’")]),s._v(" "),n("p",[n("strong",[s._v("重复计划执行")]),s._v("\non schedule every 1 second 每秒执行一次\non schedule every 1 minute 每分钟执行一次\non schedule every 1 day 没天执行一次")]),s._v(" "),n("p",[n("strong",[s._v("指定时间范围的重复计划任务")]),s._v("\n每天在20:00:00执行一次 on schedule every 1 day starts ‘2019-02-01 20:00:00’")]),s._v(" "),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("p",[s._v("每5秒向emp_log,插入当前日期时间记录")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> desc emp_log;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://www.zutuanxue.com:8000/static/media/images/2020/10/24/1603521230682.png",alt:"image20200221171724196.png"}})]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("create event e_insert on schedule every 5 second on completion preserve\nenable\ncomment '每5秒插入一次'\ndo\nbegin\n\tinsert into emp_log values(null,1,'insert1',now());\nend;\n#do call 存储过程 \n#do select 函数名\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"_10-2、事件操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10-2、事件操作"}},[s._v("#")]),s._v(" 10.2、事件操作")]),s._v(" "),n("h4",{attrs:{id:"_10-2-1、查看事件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10-2-1、查看事件"}},[s._v("#")]),s._v(" 10.2.1、查看事件")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\nshow events;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> show events;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://www.zutuanxue.com:8000/static/media/images/2020/10/24/1603521251515.png",alt:"image20200221174040539.png"}})]),s._v(" "),n("h4",{attrs:{id:"_10-2-2、启用和禁用事件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10-2-2、启用和禁用事件"}},[s._v("#")]),s._v(" 10.2.2、启用和禁用事件")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\nalter event 事件名 disable/enable;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[s._v("禁用事件")])]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> alter event e_insert disable;\nQuery OK, 0 rows affected (0.01 秒)\n\nmysql> select * from emp_log;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://www.zutuanxue.com:8000/static/media/images/2020/10/24/1603521269958.png",alt:"image20200221174401961.png"}})]),s._v(" "),n("p",[n("strong",[s._v("启用事件")])]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> alter event e_insert enable;\nQuery OK, 0 rows affected (0.02 秒)\n\nmysql> select * from emp_log;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://www.zutuanxue.com:8000/static/media/images/2020/10/24/1603521286648.png",alt:"image20200221174452171.png"}})]),s._v(" "),n("h4",{attrs:{id:"_10-2-3、删除事件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10-2-3、删除事件"}},[s._v("#")]),s._v(" 10.2.3、删除事件")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("格式：\ndrop event 事件名;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[s._v("案例：")])]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql> drop event e_insert;\nQuery OK, 0 rows affected (0.02 秒)\n\nmysql> show events;\n空的数据集 (0.01 秒)\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);