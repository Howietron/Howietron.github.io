(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{417:function(s,n,e){"use strict";e.r(n);var a=e(2),t=Object(a.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"rhceå­¦ä¹ ç¬”è®°"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rhceå­¦ä¹ ç¬”è®°"}},[s._v("#")]),s._v(" RHCEå­¦ä¹ ç¬”è®°")]),s._v(" "),n("p",[n("strong",[s._v("é‡è¦é…ç½®ä¿¡æ¯")])]),s._v(" "),n("p",[s._v("åœ¨è€ƒè¯•æœŸé—´ï¼Œé™¤äº†æ‚¨å°±åä½ç½®çš„å°å¼æœºä¹‹å¤–ï¼Œè¿˜å°†ä½¿ç”¨å¤šä¸ªè™šæ‹Ÿç³»ç»Ÿã€‚æ‚¨ä¸å…·æœ‰å°å¼æœºç³»ç»Ÿçš„ root è®¿é—®æƒï¼Œä½†å…·æœ‰å¯¹è™šæ‹Ÿç³»ç»Ÿçš„å®Œæ•´ root è®¿é—®æƒã€‚")]),s._v(" "),n("p",[n("strong",[s._v("ç³»ç»Ÿä¿¡æ¯")])]),s._v(" "),n("p",[s._v("åœ¨æœ¬è€ƒè¯•æœŸé—´ï¼Œæ‚¨å°†æ“ä½œä¸‹åˆ—è™šæ‹Ÿç³»ç»Ÿï¼š")]),s._v(" "),n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Howietron/Howietron/img/2023/09/1220230912141133.png",alt:"img"}}),s._v(" "),n("p",[s._v("è¿™äº›ç³»ç»Ÿçš„ IP åœ°å€é‡‡ç”¨é™æ€è®¾ç½®ã€‚è¯·å‹¿æ›´æ”¹è¿™äº›è®¾ç½®ã€‚")]),s._v(" "),n("p",[s._v("ä¸»æœºåç§°è§£æå·²é…ç½®ä¸ºè§£æä¸Šæ–¹åˆ—å‡ºçš„å®Œå…¨é™å®šä¸»æœºåï¼ŒåŒæ—¶ä¹Ÿè§£æä¸»æœºçŸ­åç§°ã€‚")]),s._v(" "),n("p",[n("strong",[s._v("å¸æˆ·ä¿¡æ¯")])]),s._v(" "),n("p",[s._v("æ‰€æœ‰ç³»ç»Ÿçš„ root å¯†ç æ˜¯ flectragã€‚")]),s._v(" "),n("p",[s._v("è¯·å‹¿æ›´æ”¹ root å¯†ç ã€‚é™¤éå¦æœ‰æŒ‡å®šï¼Œå¦åˆ™è¿™å°†æ˜¯ç”¨äºè®¿é—®å…¶ä»–ç³»ç»Ÿå’ŒæœåŠ¡çš„å¯†ç ã€‚æ­¤å¤–ï¼Œé™¤éå¦æœ‰æŒ‡å®šï¼Œå¦åˆ™æ­¤å¯†ç ä¹Ÿåº”ç”¨äºæ‚¨åˆ›å»ºçš„æ‰€æœ‰å¸æˆ·ï¼Œæˆ–è€…ä»»ä½•éœ€è¦è®¾ç½®å¯†ç çš„æœåŠ¡ã€‚")]),s._v(" "),n("p",[s._v("ä¸ºæ–¹ä¾¿èµ·è§ï¼Œæ‰€æœ‰ç³»ç»Ÿä¸Šå·²é¢„è£…äº† SSH å¯†é’¥ï¼Œå…è®¸åœ¨ä¸è¾“å…¥å¯†ç çš„å‰æä¸‹é€šè¿‡ SSH è¿›è¡Œ root è®¿é—®ã€‚è¯·å‹¿å¯¹ç³»ç»Ÿä¸Šçš„ root SSH é…ç½®æ–‡ä»¶è¿›è¡Œä»»ä½•ä¿®æ”¹ã€‚")]),s._v(" "),n("p",[s._v("Ansible æ§åˆ¶èŠ‚ç‚¹ä¸Šå·²åˆ›å»ºäº†ç”¨æˆ·å¸æˆ· gregã€‚æ­¤å¸æˆ·é¢„è£…äº† SSH å¯†é’¥ï¼Œå…è®¸åœ¨ Ansible æ§åˆ¶èŠ‚ç‚¹å’Œå„ä¸ª Ansible å—ç®¡èŠ‚ç‚¹ä¹‹é—´è¿›è¡Œ SSH ç™»å½•ã€‚è¯·å‹¿å¯¹ç³»ç»Ÿä¸Šçš„ greg SSH é…ç½®æ–‡ä»¶è¿›è¡Œä»»ä½•ä¿®æ”¹ã€‚æ‚¨å¯ä»¥ä» root å¸æˆ·ä½¿ç”¨ su è®¿é—®æ­¤ç”¨æˆ·å¸æˆ·ã€‚")]),s._v(" "),n("p",[n("strong",[s._v("é‡è¦ä¿¡æ¯")])]),s._v(" "),n("blockquote",[n("p",[s._v("é™¤éå¦æœ‰æŒ‡å®šï¼Œå¦åˆ™æ‚¨çš„æ‰€æœ‰å·¥ä½œï¼ˆåŒ…æ‹¬ Ansible playbookã€é…ç½®æ–‡ä»¶å’Œä¸»æœºæ¸…å•ç­‰ï¼‰åº”å½“ä¿å­˜åœ¨æ§åˆ¶èŠ‚ç‚¹ä¸Šçš„ç›®å½• /home/greg/ansible ä¸­ï¼Œå¹¶ä¸”åº”å½“å½’ greg ç”¨æˆ·æ‰€æœ‰ã€‚æ‰€æœ‰ Ansible ç›¸å…³çš„å‘½ä»¤åº”å½“ç”± greg ç”¨æˆ·ä» Ansible æ§åˆ¶èŠ‚ç‚¹ä¸Šçš„è¿™ä¸ªç›®å½•è¿è¡Œã€‚")])]),s._v(" "),n("p",[n("strong",[s._v("å…¶ä»–ä¿¡æ¯")]),s._v("\nä¸€äº›è€ƒè¯•é¡¹ç›®å¯èƒ½éœ€è¦ä¿®æ”¹ Ansible ä¸»æœºæ¸…å•ã€‚æ‚¨è¦è´Ÿè´£ç¡®ä¿æ‰€æœ‰ä»¥å‰çš„æ¸…å•ç»„å’Œé¡¹ç›®ä¿ç•™ä¸‹æ¥ï¼Œä¸ä»»ä½•å…¶ä»–æ›´æ”¹å…±å­˜ã€‚æ‚¨è¿˜è¦æœ‰ç¡®ä¿æ¸…å•ä¸­æ‰€æœ‰é»˜è®¤çš„ç»„å’Œä¸»æœºä¿ç•™æ‚¨è¿›è¡Œçš„ä»»ä½•æ›´æ”¹ã€‚")]),s._v(" "),n("p",[s._v("è€ƒè¯•ç³»ç»Ÿä¸Šçš„é˜²ç«å¢™é»˜è®¤ä¸ºä¸å¯ç”¨ï¼ŒSELinux åˆ™å¤„äºå¼ºåˆ¶æ¨¡å¼ã€‚")]),s._v(" "),n("p",[s._v("å¦‚æœéœ€è¦å®‰è£…å…¶ä»–è½¯ä»¶ï¼Œæ‚¨çš„ç‰©ç†ç³»ç»Ÿå’Œ Ansible æ§åˆ¶èŠ‚ç‚¹å¯èƒ½å·²è®¾ç½®ä¸ºæŒ‡å‘ content ä¸Šçš„ä¸‹è¿°å­˜å‚¨åº“ï¼š")]),s._v(" "),n("blockquote",[n("p",[s._v("http://content/rhel8.0/x86_64/dvd/BaseOS")]),s._v(" "),n("p",[s._v("http://content/rhel8.0/x86_64/dvd/AppStream")])]),s._v(" "),n("p",[s._v("ä¸€äº›é¡¹ç›®éœ€è¦é¢å¤–çš„æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶å·²åœ¨ä»¥ä¸‹ä½ç½®æä¾›ï¼š")]),s._v(" "),n("blockquote",[n("p",[s._v("http://materials")])]),s._v(" "),n("p",[s._v("äº§å“æ–‡æ¡£å¯ä»ä»¥ä¸‹ä½ç½®æ‰¾åˆ°ï¼š")]),s._v(" "),n("p",[s._v("http://materials/docs/ansible/html")]),s._v(" "),n("p",[s._v("å…¶ä»–èµ„æºä¹Ÿè¿›è¡Œäº†é…ç½®ï¼Œä¾›æ‚¨åœ¨è€ƒè¯•æœŸé—´ä½¿ç”¨ã€‚å…³äºè¿™äº›èµ„æºçš„å…·ä½“ä¿¡æ¯å°†åœ¨éœ€è¦è¿™äº›èµ„æºçš„é¡¹ç›®ä¸­æä¾›ã€‚")]),s._v(" "),n("p",[n("strong",[s._v("é‡è¦ä¿¡æ¯")])]),s._v(" "),n("p",[s._v("è¯·æ³¨æ„ï¼Œåœ¨è¯„åˆ†ä¹‹å‰ï¼Œæ‚¨çš„ Ansible å—ç®¡èŠ‚ç‚¹ç³»ç»Ÿå°†é‡ç½®ä¸ºè€ƒè¯•å¼€å§‹æ—¶çš„åˆå§‹çŠ¶æ€ï¼Œæ‚¨ç¼–å†™çš„ Ansible playbook å°†é€šè¿‡ä»¥ greg ç”¨æˆ·èº«ä»½ä»æ§åˆ¶èŠ‚ç‚¹ä¸Šçš„ç›®å½• /home/greg/ansible ç›®å½•è¿è¡Œæ¥åº”ç”¨ã€‚åœ¨ playbook è¿è¡Œåï¼Œç³»ç»Ÿä¼šå¯¹æ‚¨çš„å—ç®¡èŠ‚ç‚¹è¿›è¡Œè¯„ä¼°ï¼Œä»¥åˆ¤æ–­å®ƒä»¬æ˜¯å¦æŒ‰ç…§è§„å®šè¿›è¡Œäº†é…ç½®ã€‚")]),s._v(" "),n("h2",{attrs:{id:"å®‰è£…å’Œé…ç½®-ansible"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…å’Œé…ç½®-ansible"}},[s._v("#")]),s._v(" "),n("strong",[s._v("å®‰è£…å’Œé…ç½® Ansible")])]),s._v(" "),n("blockquote",[n("p",[s._v("æŒ‰ç…§ä¸‹æ–¹æ‰€è¿°ï¼Œåœ¨æ§åˆ¶èŠ‚ç‚¹ 172.25.250.254 ä¸Šå®‰è£…å’Œé…ç½® Ansibleï¼š")]),s._v(" "),n("p",[s._v("å®‰è£…æ‰€éœ€çš„è½¯ä»¶åŒ…")]),s._v(" "),n("p",[s._v("åˆ›å»ºåä¸º /home/greg/ansible/inventory çš„é™æ€æ¸…å•æ–‡ä»¶ï¼Œä»¥æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š")]),s._v(" "),n("p",[s._v("172.25.250.9 æ˜¯ dev ä¸»æœºç»„çš„æˆå‘˜")]),s._v(" "),n("p",[s._v("172.25.250.10 æ˜¯ test ä¸»æœºç»„çš„æˆå‘˜")]),s._v(" "),n("p",[s._v("172.25.250.11 å’Œ 172.25.250.12 æ˜¯ prod ä¸»æœºç»„çš„æˆå‘˜")]),s._v(" "),n("p",[s._v("172.25.250.13 æ˜¯ balancers ä¸»æœºç»„çš„æˆå‘˜")]),s._v(" "),n("p",[s._v("prod ç»„æ˜¯ webservers ä¸»æœºç»„çš„æˆå‘˜")]),s._v(" "),n("p",[s._v("åˆ›å»ºåä¸º /home/greg/ansible/ansible.cfg çš„é…ç½®æ–‡ä»¶ï¼Œä»¥æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š")]),s._v(" "),n("p",[s._v("ä¸»æœºæ¸…å•æ–‡ä»¶ä¸º /home/greg/ansible/inventory")]),s._v(" "),n("p",[s._v("playbook ä¸­ä½¿ç”¨çš„è§’è‰²çš„ä½ç½®åŒ…æ‹¬ /home/greg/ansible/roles")])]),s._v(" "),n("p",[n("strong",[s._v("è§£é¢˜æ–¹æ³•ï¼š")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[greg@bastion ~]$ sudo yum install -y ansible\n[greg@bastion ~]$ mkdir -p /home/greg/ansible\n[greg@bastion ~]$ cd /home/greg/ansible\n[greg@bastion ansible]$ vim inventory\n[dev]\n172.25.250.9\n[test]\n172.25.250.10\n[prod]\n172.25.250.11\n172.25.250.12\n[balancers]\n172.25.250.13\n[webservers:children]\nprod\n[all:vars]\nansible_user=root\nansible_password=redhat\n[greg@bastion ansible]$ cp /etc/ansible/ansible.cfg ./\n[greg@bastion ansible]$ mkdir roles\n[greg@bastion ansible]$ vim /home/greg/ansible/ansible.cfg\n#æ€»å…±åªä¿®æ”¹å››è¡Œ\ninventory = /home/greg/ansible/inventory\nroles_path = /home/greg/ansible/roles\nhost_key_checking = False\t\t\t\t # 68è¡Œ\nremote_user = root                       # 107è¡Œ\n[greg@bastion ansible]$ ansible --version\n[greg@bastion ansible]$ ansible-inventory --graph\n[greg@bastion ansible]$ ansible all -m ping # çœ‹é…ç½®æ–‡ä»¶æ˜¯å¦ç”Ÿæ•ˆ\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br")])]),n("h2",{attrs:{id:"åˆ›å»ºå’Œè¿è¡Œ-ansible-ä¸´æ—¶å‘½ä»¤"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºå’Œè¿è¡Œ-ansible-ä¸´æ—¶å‘½ä»¤"}},[s._v("#")]),s._v(" "),n("strong",[s._v("åˆ›å»ºå’Œè¿è¡Œ Ansible ä¸´æ—¶å‘½ä»¤")])]),s._v(" "),n("blockquote",[n("p",[s._v("ä½œä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œæ‚¨éœ€è¦åœ¨å—ç®¡èŠ‚ç‚¹ä¸Šå®‰è£…è½¯ä»¶ã€‚")]),s._v(" "),n("p",[s._v("è¯·æŒ‰ç…§æ­£æ–‡æ‰€è¿°ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º /home/greg/ansible/adhoc.sh çš„ shell è„šæœ¬ï¼Œè¯¥è„šæœ¬å°†ä½¿ç”¨ Ansible ä¸´æ—¶å‘½ä»¤åœ¨å„ä¸ªå—ç®¡èŠ‚ç‚¹ä¸Šå®‰è£… yum å­˜å‚¨åº“ï¼š")]),s._v(" "),n("p",[s._v("å­˜å‚¨åº“1ï¼š")]),s._v(" "),n("p",[s._v("å­˜å‚¨åº“çš„åç§°ä¸º EX294_BASE")]),s._v(" "),n("p",[s._v("æè¿°ä¸º EX294 base software")]),s._v(" "),n("p",[s._v("åŸºç¡€ URL ä¸º http://content/rhel8.0/x86_64/dvd/BaseOS")]),s._v(" "),n("p",[s._v("GPG ç­¾åæ£€æŸ¥ä¸ºå¯ç”¨çŠ¶æ€")]),s._v(" "),n("p",[s._v("GPG å¯†é’¥ URL ä¸º http://content/rhel8.0/x86_64/dvd/RPM-GPG-KEY-redhat-release")]),s._v(" "),n("p",[s._v("å­˜å‚¨åº“ä¸ºå¯ç”¨çŠ¶æ€")]),s._v(" "),n("p",[s._v("å­˜å‚¨åº“2ï¼š")]),s._v(" "),n("p",[s._v("å­˜å‚¨åº“çš„åç§°ä¸º EX294_STREAM")]),s._v(" "),n("p",[s._v("æè¿°ä¸º EX294 stream software")]),s._v(" "),n("p",[s._v("åŸºç¡€ URL ä¸º http://content/rhel8.0/x86_64/dvd/AppStream")]),s._v(" "),n("p",[s._v("GPG ç­¾åæ£€æŸ¥ä¸ºå¯ç”¨çŠ¶æ€")]),s._v(" "),n("p",[s._v("GPG å¯†é’¥ URL ä¸º http://content/rhel8.0/x86_64/dvd/RPM-GPG-KEY-redhat-release")]),s._v(" "),n("p",[s._v("å­˜å‚¨åº“ä¸ºå¯ç”¨çŠ¶æ€")])]),s._v(" "),n("p",[n("strong",[s._v("è§£é¢˜æ–¹æ³•ï¼š")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('[greg@bastion ansible]$ ansible-doc yum_repository\n[greg@bastion ansible]$ vim adhoc.sh\n#!/bin/bash\nansible all -m yum_repository -a \'name="EX294_BASE" description="EX294 base software" baseurl="http://content/rhel8.0/x86_64/dvd/BaseOS" gpgcheck=yes enabled=1 gpgkey="http://content/rhel8.0/x86_64/dvd/RPM-GPG-KEY-redhat-release"\'\nansible all -m yum_repository -a \'name="EX294_STREAM" description="EX294 stream software" baseurl="http://content/rhel8.0/x86_64/dvd/AppStream" gpgcheck=yes enabled=1 gpgkey="http://content/rhel8.0/x86_64/dvd/RPM-GPG-KEY-redhat-release"\'\n[greg@bastion ansible]$ chmod +x adhoc.sh\n[greg@bastion ansible]$ ./adhoc.sh\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("éªŒè¯")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("ansible dev,test,prod -m shell -a \"rpm -qa | grep -Ei 'php|ariadb'\"\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"å®‰è£…è½¯ä»¶åŒ…"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…è½¯ä»¶åŒ…"}},[s._v("#")]),s._v(" "),n("strong",[s._v("å®‰è£…è½¯ä»¶åŒ…")])]),s._v(" "),n("blockquote",[n("p",[s._v("åˆ›å»ºä¸€ä¸ªåä¸º /home/greg/ansible/packages.yml çš„ playbook :")]),s._v(" "),n("p",[s._v("å°† php å’Œ mariadb è½¯ä»¶åŒ…å®‰è£…åˆ° devã€test å’Œ prod ä¸»æœºç»„ä¸­çš„ä¸»æœºä¸Š")]),s._v(" "),n("p",[s._v("å°† RPM Development Tools è½¯ä»¶åŒ…ç»„å®‰è£…åˆ° dev ä¸»æœºç»„ä¸­çš„ä¸»æœºä¸Š")]),s._v(" "),n("p",[s._v("å°† dev ä¸»æœºç»„ä¸­ä¸»æœºä¸Šçš„æ‰€æœ‰è½¯ä»¶åŒ…æ›´æ–°ä¸ºæœ€æ–°ç‰ˆæœ¬")])]),s._v(" "),n("p",[n("strong",[s._v("è§£é¢˜æ–¹æ³•ï¼š")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\n---\n- name: å®‰è£…è½¯ä»¶åŒ…A\n  hosts: dev,test,prod\n  tasks:\n          - name: one\n            yum:\n                    name: php\n                    state: latest\n          - name: two\n            yum:\n                    name: mariadb\n                    state: latest\n- name: å®‰è£…è½¯ä»¶åŒ…B\n  hosts: dev\n  tasks:\n          - name: one\n            yum:\n                    name: "@RPM Development Tools"\n                    state: latest\n          - name: two\n            yum:\n                    name: "*"\n                    state: latest\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("h2",{attrs:{id:"ä½¿ç”¨-rhel-ç³»ç»Ÿè§’è‰²"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨-rhel-ç³»ç»Ÿè§’è‰²"}},[s._v("#")]),s._v(" "),n("strong",[s._v("ä½¿ç”¨ RHEL ç³»ç»Ÿè§’è‰²")])]),s._v(" "),n("p",[n("strong",[s._v("ğŸ˜€ä½¿ç”¨ RHEL ç³»ç»Ÿè§’è‰²")])]),s._v(" "),n("blockquote",[n("p",[s._v("å®‰è£… RHEL ç³»ç»Ÿè§’è‰²è½¯ä»¶åŒ…ï¼Œå¹¶åˆ›å»ºç¬¦åˆä»¥ä¸‹æ¡ä»¶çš„ playbook /home/greg/ansible/timesync.yml ï¼š")]),s._v(" "),n("p",[s._v("åœ¨æ‰€æœ‰å—ç®¡èŠ‚ç‚¹ä¸Šè¿è¡Œ")]),s._v(" "),n("p",[s._v("ä½¿ç”¨ timesync è§’è‰²")]),s._v(" "),n("p",[s._v("é…ç½®è¯¥è§’è‰²ï¼Œä»¥ä½¿ç”¨å½“å‰æœ‰æ•ˆçš„ NTP æä¾›å•†")]),s._v(" "),n("p",[s._v("é…ç½®è¯¥è§’è‰²ï¼Œä»¥ä½¿ç”¨æ—¶é—´æœåŠ¡å™¨ 172.25.254.254")]),s._v(" "),n("p",[s._v("é…ç½®è¯¥è§’è‰²ï¼Œä»¥å¯ç”¨ iburst å‚æ•°")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("greg@bastion ansible"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" rhel-system-roles\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("greg@bastion ansible"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" ansible.cfg\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ä»…ä¿®æ”¹ä¸€è¡Œ")]),s._v("\nroles_path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /home/greg/ansible/roles:/usr/share/ansible/roles\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("greg@bastion ansible"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ ansible-galaxy list\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("greg@bastion ansible"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/share/doc/rhel-system-roles/timesync/example-timesync-playbook.yml timesync.yml\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("greg@bastion ansible"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" timesync.yml\n---\n- hosts: all\n  vars:\n    timesync_ntp_servers:\n      - hostname: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.25")]),s._v(".254.254\n        iburst: "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n  roles:\n    - rhel-system-roles.timesync\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("éªŒè¯")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("ansible all -m shell -a 'cat /etc/chrony.conf'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"ä½¿ç”¨-ansible-galaxy-å®‰è£…è§’è‰²"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨-ansible-galaxy-å®‰è£…è§’è‰²"}},[s._v("#")]),s._v(" "),n("strong",[s._v("ä½¿ç”¨ Ansible Galaxy å®‰è£…è§’è‰²")])]),s._v(" "),n("blockquote",[n("p",[s._v("ä½¿ç”¨ Ansible Galaxy å’Œè¦æ±‚æ–‡ä»¶ /home/greg/ansible/roles/requirements.yml ã€‚ä»ä»¥ä¸‹ URL ä¸‹è½½è§’è‰²å¹¶å®‰è£…åˆ° /home/greg/ansible/roles ï¼š")]),s._v(" "),n("p",[s._v("http://materials/haproxy.tar æ­¤è§’è‰²çš„åç§°åº”å½“ä¸º balancer")]),s._v(" "),n("p",[s._v("http://materials/phpinfo.tar æ­¤è§’è‰²çš„åç§°åº”å½“ä¸º phpinfo")])]),s._v(" "),n("p",[n("strong",[s._v("è§£é¢˜æ–¹æ³•ï¼š")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[greg@bastion ansible]$ mkdir roles\n[greg@bastion ansible]$ vim roles/requirements.yml\n---\n- src: http://materials/haproxy.tar\n  name: balancer\n- src: http://materials/phpinfo.tar\n  name: phpinfo\n[greg@bastion ansible]$ ansible-galaxy install -r requirements.yml\n[greg@bastion ansible]$ ansible-galaxy list\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("æ³¨æ„ ansible-galaxy install -réœ€è¦æ‰§è¡Œä¸¤éï¼Œå¦åˆ™åˆ¤åˆ†å¯èƒ½æ²¡åˆ†")]),s._v(" "),n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Howietron/Howietron/img/2023/09/1220230912141253.png",alt:"image-20230902235326442"}}),s._v(" "),n("h2",{attrs:{id:"åˆ›å»ºå’Œä½¿ç”¨è§’è‰²"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºå’Œä½¿ç”¨è§’è‰²"}},[s._v("#")]),s._v(" "),n("strong",[s._v("åˆ›å»ºå’Œä½¿ç”¨è§’è‰²")])]),s._v(" "),n("blockquote",[n("p",[s._v("æ ¹æ®ä¸‹åˆ—è¦æ±‚ï¼Œåœ¨ /home/greg/ansible/roles ä¸­åˆ›å»ºåä¸º apache çš„è§’è‰²ï¼š")]),s._v(" "),n("p",[s._v("httpd è½¯ä»¶åŒ…å·²å®‰è£…ï¼Œè®¾ä¸ºåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶å¯ç”¨å¹¶å¯åŠ¨")]),s._v(" "),n("p",[s._v("é˜²ç«å¢™å·²å¯ç”¨å¹¶æ­£åœ¨è¿è¡Œï¼Œå¹¶ä½¿ç”¨å…è®¸è®¿é—® Web æœåŠ¡å™¨çš„è§„åˆ™")]),s._v(" "),n("p",[s._v("æ¨¡æ¿æ–‡ä»¶ index.html.j2 å·²å­˜åœ¨ï¼Œç”¨äºåˆ›å»ºå…·æœ‰ä»¥ä¸‹è¾“å‡ºçš„æ–‡ä»¶ /var/www/html/index.html ï¼š")]),s._v(" "),n("p",[s._v("Welcome to HOSTNAME on IPADDRESS")]),s._v(" "),n("p",[s._v("å…¶ä¸­ï¼ŒHOSTNAME æ˜¯å—ç®¡èŠ‚ç‚¹çš„å®Œå…¨é™å®šåŸŸåï¼ŒIPADDRESS åˆ™æ˜¯å—ç®¡èŠ‚ç‚¹çš„ IP åœ°å€ã€‚")])]),s._v(" "),n("p",[s._v("**æ³¨æ„ï¼š**è§’è‰²åˆ›å»ºå‡ºæ¥å°±å¯ä»¥äº†ï¼Œæ— éœ€å•ç‹¬è¿›è¡Œè°ƒç”¨æµ‹è¯•ã€ä¸€æ—¦è°ƒç”¨ä½¿ç”¨ååè€Œä¼šå¯¼è‡´ä¸‹é¢é¢˜ç›®æŠ¥é”™ï¼Œä¸‹é¢é‚£é“é¢˜é©¬ä¸Šä¼šè°ƒç”¨apacheè§’è‰²ï¼ŒæŒ‰ç…§ç½‘é¡µå†…å®¹åŠæ­¥éª¤æ“ä½œå³å¯~")]),s._v(" "),n("p",[s._v("è§£é¢˜æ–¹æ³•ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[greg@bastion roles]$ ansible-galaxy init apache\n[greg@bastion roles]$ vim apache/tasks/main.yml\n---\n- name: add httpd\n  yum:\n          name: httpd\n          state: latest\n- name: start httpd\n  service:\n          name: httpd\n          state: started\n          enabled: yes\n          \n- name: start firewalld\n  service:\n          name: firewalld\n          state: started\n          enabled: yes         \n- name: on http\n  firewalld:\n          service: http\t\t # æœåŠ¡åç§°\n          permanent: yes\t # é‡å¯åç”Ÿæ•ˆ\n          state: enabled     # å¼€å¯\n          immediate: yes\t # æ˜¯å¦ç«‹å³åº”ç”¨\n- name: create index\n  template:\n          src: index.html.j2\n          dest: /var/www/html/index.html\n[greg@bastion roles]$ vim apache/templates/index.html.j2\nWelcome to {{ ansible_fqdn }} on {{ ansible_default_ipv4.address }}\n\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br")])]),n("p",[s._v("æŠ€å·§ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("ansible dev -m setup -a 'filter=\"ipv4\"'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"ä»-ansible-galaxy-ä½¿ç”¨è§’è‰²"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä»-ansible-galaxy-ä½¿ç”¨è§’è‰²"}},[s._v("#")]),s._v(" "),n("strong",[s._v("ä» Ansible Galaxy ä½¿ç”¨è§’è‰²")])]),s._v(" "),n("blockquote",[n("p",[s._v("æ ¹æ®ä¸‹åˆ—è¦æ±‚ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º /home/greg/ansible/roles.yml çš„ playbook ï¼š")]),s._v(" "),n("p",[s._v("playbook ä¸­åŒ…å«ä¸€ä¸ª playï¼Œ è¯¥ play åœ¨ balancers ä¸»æœºç»„ä¸­çš„ä¸»æœºä¸Šè¿è¡Œå¹¶å°†ä½¿ç”¨ balancer è§’è‰²ã€‚")]),s._v(" "),n("p",[s._v("æ­¤è§’è‰²é…ç½®ä¸€é¡¹æœåŠ¡ï¼Œä»¥åœ¨ webservers ä¸»æœºç»„ä¸­çš„ä¸»æœºä¹‹é—´å¹³è¡¡ Web æœåŠ¡å™¨è¯·æ±‚çš„è´Ÿè½½ã€‚")]),s._v(" "),n("p",[s._v("æµè§ˆåˆ° balancers ä¸»æœºç»„ä¸­çš„ä¸»æœºï¼ˆä¾‹å¦‚ http://172.25.250.13 ï¼‰å°†ç”Ÿæˆä»¥ä¸‹è¾“å‡ºï¼š")]),s._v(" "),n("p",[s._v("Welcom to serverb.lab.example.com on 172.25.250.11")]),s._v(" "),n("p",[s._v("é‡æ–°åŠ è½½æµè§ˆå™¨å°†ä»å¦ä¸€ Web æœåŠ¡å™¨ç”Ÿæˆè¾“å‡ºï¼š")]),s._v(" "),n("p",[s._v("Welcom to serverc.lab.example.com on 172.25.250.12")]),s._v(" "),n("p",[s._v("playbook ä¸­åŒ…å«ä¸€ä¸ª playï¼Œ è¯¥ play åœ¨ webservers ä¸»æœºç»„ä¸­çš„ä¸»æœºä¸Šè¿è¡Œå¹¶å°†ä½¿ç”¨ phpinfo è§’è‰²ã€‚")]),s._v(" "),n("p",[s._v("è¯·é€šè¿‡ URL /hello.php æµè§ˆåˆ° webservers ä¸»æœºç»„ä¸­çš„ä¸»æœºå°†ç”Ÿæˆä»¥ä¸‹è¾“å‡ºï¼š")]),s._v(" "),n("p",[s._v("Hello PHP World from FQDN")]),s._v(" "),n("p",[s._v("å…¶ä¸­ï¼ŒFQDN æ˜¯ä¸»æœºçš„å®Œå…¨é™å®šåç§°ã€‚")]),s._v(" "),n("p",[s._v("Hello PHP World from")]),s._v(" "),n("p",[s._v("serverb.lab.example.com")]),s._v(" "),n("p",[s._v("å¦å¤–è¿˜æœ‰ PHP é…ç½®çš„å„ç§è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚å®‰è£…çš„ PHP ç‰ˆæœ¬ç­‰ã€‚")]),s._v(" "),n("p",[s._v("åŒæ ·ï¼Œæµè§ˆåˆ° http://172.25.250.12/hello.php ä¼šç”Ÿæˆä»¥ä¸‹è¾“å‡ºï¼š")]),s._v(" "),n("p",[s._v("Hello PHP World from")]),s._v(" "),n("p",[s._v("serverc.lab.example.com")]),s._v(" "),n("p",[s._v("å¦å¤–è¿˜æœ‰ PHP é…ç½®çš„å„ç§è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚å®‰è£…çš„ PHP ç‰ˆæœ¬ç­‰ã€‚")])]),s._v(" "),n("p",[s._v("è§£é¢˜æ–¹æ³•ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[greg@bastion ansible]$ vim roles.yml\n---\n- name: one\t  # è€ƒè¯•æ—¶ï¼Œè¯¥é¡¹éœ€è¦æ”¾æœ€åï¼Œå¦åˆ™å‰§æœ¬æ‰§è¡ŒæŠ¥é”™\n  hosts: balancers\n  roles:\n          - balancer\n- name: two\n  hosts: webservers\n  roles:\n          - phpinfo\n- name: three\n  hosts: webservers   # é¡µé¢æµ‹è¯•æ˜¯åšè´Ÿè½½å‡è¡¡æ—¶é¡µé¢åˆ·æ–°è´Ÿè½½åˆ‡æ¢æ¯”è¾ƒæ…¢ï¼ˆåˆ·æ–°é¡µé¢ä¸åƒæ¨¡æ‹Ÿç¯å¢ƒé‚£ä¹ˆå¿«ï¼‰\n  roles:\n          - apache\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h2",{attrs:{id:"åˆ›å»ºå’Œä½¿ç”¨é€»è¾‘å·"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºå’Œä½¿ç”¨é€»è¾‘å·"}},[s._v("#")]),s._v(" "),n("strong",[s._v("åˆ›å»ºå’Œä½¿ç”¨é€»è¾‘å·")])]),s._v(" "),n("blockquote",[n("p",[s._v("åˆ›å»ºä¸€ä¸ªåä¸º /home/greg/ansible/lv.yml çš„ playbook ï¼Œå®ƒå°†åœ¨æ‰€æœ‰å—ç®¡èŠ‚ç‚¹ä¸Šè¿è¡Œä»¥æ‰§è¡Œä¸‹åˆ—ä»»åŠ¡ï¼š")]),s._v(" "),n("p",[s._v("åˆ›å»ºç¬¦åˆä»¥ä¸‹è¦æ±‚çš„é€»è¾‘å·ï¼š")]),s._v(" "),n("p",[s._v("é€»è¾‘å·åˆ›å»ºåœ¨ research å·ç»„ä¸­")]),s._v(" "),n("p",[s._v("é€»è¾‘å·åç§°ä¸º data")]),s._v(" "),n("p",[s._v("é€»è¾‘å·å¤§å°ä¸º 1500 MiB")]),s._v(" "),n("p",[s._v("ä½¿ç”¨ ext4 æ–‡ä»¶ç³»ç»Ÿæ ¼å¼åŒ–é€»è¾‘å·")]),s._v(" "),n("p",[s._v("å¦‚æœæ— æ³•åˆ›å»ºè¯·æ±‚çš„é€»è¾‘å·å¤§å°ï¼Œåº”æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯")]),s._v(" "),n("p",[s._v("Could not create logical volume of that size")]),s._v(" "),n("p",[s._v("ï¼Œå¹¶ä¸”åº”æ”¹ä¸ºä½¿ç”¨å¤§å° 800 MiBã€‚")]),s._v(" "),n("p",[s._v("å¦‚æœå·ç»„ research ä¸å­˜åœ¨ï¼Œåº”æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯")]),s._v(" "),n("p",[s._v("Volume group done not exist")]),s._v(" "),n("p",[s._v("ã€‚")]),s._v(" "),n("p",[s._v("ä¸è¦ä»¥ä»»ä½•æ–¹å¼æŒ‚è½½é€»è¾‘å·")])]),s._v(" "),n("p",[n("strong",[s._v("è§£é¢˜æ–¹æ³•ï¼š")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[greg@bastion ansible]$ vim lv.yml\n---\n- name: åˆ›å»ºå’Œä½¿ç”¨é€»è¾‘å·\n  hosts: all\n  tasks:\n          - block:\n                - name: one\n                  lvol:\n                          vg: research\n                          lv: data\n                          size: 1500\n                - name: two\n                  filesystem:\n                          fstype: ext4\n                          dev: /dev/research/data\n            rescue:\n                  - name: err msg 1\n                    debug:\n                          msg: Could not create logical volume of that size\n                  - name: three\n                    lvol:\n                        vg: research\n                        lv: data\n                        size: 800\n                    when: ansible_lvm.vgs.research is defined \n                  - name: err msg 1\n                    debug:\n                          msg: Volume group done not exist\n                    when: ansible_lvm.vgs.research is undefined\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br")])]),n("h2",{attrs:{id:"ç”Ÿæˆä¸»æœºæ–‡ä»¶"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç”Ÿæˆä¸»æœºæ–‡ä»¶"}},[s._v("#")]),s._v(" "),n("strong",[s._v("ç”Ÿæˆä¸»æœºæ–‡ä»¶")])]),s._v(" "),n("blockquote",[n("p",[s._v("å°†ä¸€ä¸ªåˆå§‹æ¨¡æ¿æ–‡ä»¶ä» http://materials/hosts.j2 ä¸‹è½½åˆ° /home/greg/ansible")]),s._v(" "),n("p",[s._v("å®Œæˆè¯¥æ¨¡æ¿ï¼Œä»¥ä¾¿ç”¨å®ƒç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼šé’ˆå¯¹æ¯ä¸ªæ¸…å•ä¸»æœºåŒ…å«ä¸€è¡Œå†…å®¹ï¼Œå…¶æ ¼å¼ä¸ /etc/hosts ç›¸åŒ")]),s._v(" "),n("p",[s._v("åˆ›å»ºåä¸º /home/greg/ansible/hosts.yml çš„ playbook ï¼Œå®ƒå°†ä½¿ç”¨æ­¤æ¨¡æ¿åœ¨ dev ä¸»æœºç»„ä¸­çš„ä¸»æœºä¸Šç”Ÿæˆæ–‡ä»¶ /etc/myhosts ã€‚")]),s._v(" "),n("p",[s._v("è¯¥ playbook è¿è¡Œåï¼Œ dev ä¸»æœºç»„ä¸­ä¸»æœºä¸Šçš„æ–‡ä»¶ /etc/myhosts åº”é’ˆå¯¹æ¯ä¸ªå—ç®¡ä¸»æœºåŒ…å«ä¸€è¡Œå†…å®¹ï¼š")]),s._v(" "),n("p",[s._v("127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4")]),s._v(" "),n("p",[s._v("::1 localhost localhost.localdomain localhost6 localhost6.localdomain6")]),s._v(" "),n("p",[s._v("172.25.250.9 workstation.lab.example.com workstation")]),s._v(" "),n("p",[s._v("172.25.250.10 servera.lab.example.com servera")]),s._v(" "),n("p",[s._v("172.25.250.11 serverb.lab.example.com serverb")]),s._v(" "),n("p",[s._v("172.25.250.12 serverc.lab.example.com serverc")]),s._v(" "),n("p",[s._v("172.25.250.13 serverd.lab.example.com serverd")]),s._v(" "),n("p",[s._v("æ³¨ï¼šæ¸…å•ä¸»æœºåç§°çš„æ˜¾ç¤ºé¡ºåºä¸é‡è¦ã€‚")])]),s._v(" "),n("p",[s._v("**æ¸©é¦¨æç¤ºï¼š**ç›®å‰è§£é¢˜æ–¹æ³•Aã€Bæ²¡æœ‰ç»å¯¹å¥½åä¹‹åˆ†ï¼Œä½¿ç”¨Aæ›´ç®€å•ï¼Œä½†å°‘éƒ¨åˆ†åŒå­¦åæ˜ ä¼šè¢«æ‰£åˆ†ï¼Œä½†ç›®å‰è¿˜ä¸èƒ½ç¡®å®šæ˜¯å¦ä¸ºå­¦ç”Ÿè€ƒè¯•ä¸­è‡ªå·±çŠ¯äº†å…¶ä»–é”™è¯¯å¯¼è‡´çš„ã€‚è€ŒBæ–¹æ³•æ˜¯çº¢å¸½åŸå‚æ ‡å‡†ç­”æ¡ˆï¼Œä»ç†è®ºä¸Šæ›´åŠ é è°±ï¼Œç¼ºç‚¹æ˜¯è®°å¿†å¤æ‚ã€‚è¯·åŒå­¦ä»¬æ ¹æ®è‡ªå·±çš„å¤‡è€ƒè¿›åº¦å’Œè‡ªèº«æƒ…å†µè¿›è¡Œå–èˆã€‚")]),s._v(" "),n("p",[s._v("è§£é¢˜æ–¹æ³•Aï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[greg@bastion ansible]$ wget http://materials/hosts.j2\n[greg@bastion ansible]$ vim hosts.j2\n127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1 localhost localhost.localdomain localhost6 localhost6.localdomain6\n\n172.25.250.9    workstation.lab.example.com      workstation\n172.25.250.10   servera.lab.example.com servera\n172.25.250.11   serverb.lab.example.com serverb\n172.25.250.12   serverc.lab.example.com serverc\n172.25.250.13   serverd.lab.example.com serverd\n[greg@bastion ansible]$ vim hosts.yml\n---\n- name: ç”Ÿæˆä¸»æœºæ–‡ä»¶\n  hosts: dev\n  tasks:\n          - name: one\n            template:\n                    src: /home/greg/ansible/hosts.j2\n                    dest: /etc/myhosts\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("p",[s._v("è§£é¢˜æ–¹æ³•Bï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[greg@bastion ansible]$ wget http://materials/hosts.j2\n[greg@bastion ansible]$ vim hosts.j2\n127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1 localhost localhost.localdomain localhost6 localhost6.localdomain\n{% for host in groups['all'] %}\n{{ hostvars[host]['ansible_facts']['default_ipv4']['address'] }} {{ hostvars[host]['ansible_facts']['fqdn'] }} {{ hostvars[host]['ansible_facts']['hostname'] }}\n{% endfor %}\n[greg@bastion ansible]$ vim hosts.yml\n---\n- name: ç”Ÿæˆä¸»æœºæ–‡ä»¶\n  hosts: all\n  tasks:\n          - name: one\n            template:\n                    src: /home/greg/ansible/hosts.j2\n                    dest: /etc/myhosts\n            when: 'inventory_hostname in groups.dev'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h2",{attrs:{id:"ä¿®æ”¹æ–‡ä»¶å†…å®¹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä¿®æ”¹æ–‡ä»¶å†…å®¹"}},[s._v("#")]),s._v(" "),n("strong",[s._v("ä¿®æ”¹æ–‡ä»¶å†…å®¹")])]),s._v(" "),n("blockquote",[n("p",[s._v("æŒ‰ç…§ä¸‹æ–¹æ‰€è¿°ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º /home/greg/ansible/issue.yml çš„ playbook ï¼š")]),s._v(" "),n("p",[s._v("è¯¥ playbook å°†åœ¨æ‰€æœ‰æ¸…å•ä¸»æœºä¸Šè¿è¡Œ")]),s._v(" "),n("p",[s._v("è¯¥ playbook ä¼šå°† /etc/issue çš„å†…å®¹æ›¿æ¢ä¸ºä¸‹æ–¹æ‰€ç¤ºçš„ä¸€è¡Œæ–‡æœ¬ï¼š")]),s._v(" "),n("p",[s._v("åœ¨ dev ä¸»æœºç»„ä¸­çš„ä¸»æœºä¸Šï¼Œè¿™è¡Œæ–‡æœ¬æ˜¾ç¤º ä¸ºï¼šDevelopment")]),s._v(" "),n("p",[s._v("åœ¨ test ä¸»æœºç»„ä¸­çš„ä¸»æœºä¸Šï¼Œè¿™è¡Œæ–‡æœ¬æ˜¾ç¤º ä¸ºï¼šTest")]),s._v(" "),n("p",[s._v("åœ¨ prod ä¸»æœºç»„ä¸­çš„ä¸»æœºä¸Šï¼Œè¿™è¡Œæ–‡æœ¬æ˜¾ç¤º ä¸ºï¼šProduction")])]),s._v(" "),n("p",[n("strong",[s._v("è§£é¢˜æ–¹æ³•ï¼š")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[greg@bastion ansible]$ vim issue.yml\n---\n- name: ä¿®æ”¹æ–‡ä»¶å†…å®¹\n  hosts: all\n  tasks:\n          - name: one\n            copy:\n                    content: 'Development'\n                    dest: /etc/issue\n            when: inventory_hostname in groups.dev\n          - name: two\n            copy:\n                    content: 'Test'\n                    dest: /etc/issue\n            when: inventory_hostname in groups.test\n          - name: three\n            copy:\n                    content: 'Production'\n                    dest: /etc/issue\n            when: inventory_hostname in groups.prod\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("h2",{attrs:{id:"åˆ›å»º-web-å†…å®¹ç›®å½•"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º-web-å†…å®¹ç›®å½•"}},[s._v("#")]),s._v(" "),n("strong",[s._v("åˆ›å»º Web å†…å®¹ç›®å½•")])]),s._v(" "),n("blockquote",[n("p",[s._v("æŒ‰ç…§ä¸‹æ–¹æ‰€è¿°ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º /home/greg/ansible/webcontent.yml çš„ playbook ï¼š")]),s._v(" "),n("p",[s._v("è¯¥ playbook åœ¨ dev ä¸»æœºç»„ä¸­çš„å—ç®¡èŠ‚ç‚¹ä¸Šè¿è¡Œ")]),s._v(" "),n("p",[s._v("åˆ›å»ºç¬¦åˆä¸‹åˆ—è¦æ±‚çš„ç›®å½• /webdev ï¼š")]),s._v(" "),n("p",[s._v("æ‰€æœ‰è€…ä¸º webdev ç»„")]),s._v(" "),n("p",[s._v("å…·æœ‰å¸¸è§„æƒé™ï¼šowner=read+write+execute ï¼Œ group=read+write+execute ï¼Œother=read+execute")]),s._v(" "),n("p",[s._v("å…·æœ‰ç‰¹æ®Šæƒé™ï¼šè®¾ç½®ç»„ ID")]),s._v(" "),n("p",[s._v("ç”¨ç¬¦å·é“¾æ¥å°† /var/www/html/webdev é“¾æ¥åˆ° /webdev")]),s._v(" "),n("p",[s._v("åˆ›å»ºæ–‡ä»¶ /webdev/index.html ï¼Œå…¶ä¸­åŒ…å«å¦‚ä¸‹æ‰€ç¤ºçš„å•è¡Œæ–‡ä»¶ï¼š Development")]),s._v(" "),n("p",[s._v("åœ¨ dev ä¸»æœºç»„ä¸­ä¸»æœºä¸Šæµè§ˆæ­¤ç›®å½•ï¼ˆä¾‹å¦‚ http://172.25.250.9/webdev/ ï¼‰å°†ç”Ÿæˆä»¥ä¸‹è¾“å‡ºï¼š")]),s._v(" "),n("p",[s._v("Development")])]),s._v(" "),n("p",[n("strong",[s._v("è§£é¢˜æ–¹æ³•ï¼š")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("greg@bastion ansible"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" webcontent.yml\n---\n- name: create web content\n  hosts: dev\n  tasks:\n          - name: create group     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ¨¡æ‹Ÿç¯å¢ƒéœ€è¦åŠ è¿™ä¸ª")]),s._v("\n            group:\n                    name: webdev\n                    state: present\n          - name: create /webdev\n            file:\n                    path: /webdev\n                    group: webdev\n                    mode: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2775'")]),s._v("\n                    state: directory\n          - name: create "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v("\n            file:\n                    src: /webdev\n                    dest: /var/www/html/webdev\n                    state: "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v("\n          - name: create index.html\n            copy:\n                    content: "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Development'")]),s._v("\n                    dest: /webdev/index.html\n                    setype: httpd_sys_content_t\n          - name: "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" httpd\n            yum:\n                    name: httpd\n                    state: latest\n          - name: start httpd\n            service:\n                    name: httpd\n                    state: started\n                    enabled: "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n          - name: "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" http "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" on firewall\n            firewalld:\n                    service: http\n                    state: enabled\n                    immediate: "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n                    permanent: "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br")])]),n("h2",{attrs:{id:"é…ç½®-cron-ä½œä¸š-æ–°å¢"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®-cron-ä½œä¸š-æ–°å¢"}},[s._v("#")]),s._v(" "),n("strong",[s._v("é…ç½® cron ä½œä¸šï¼ˆæ–°å¢ï¼‰")])]),s._v(" "),n("blockquote",[n("p",[s._v("åˆ›å»ºä¸€ä¸ªåä¸º /home/greg/ansible/cron.yml çš„ playbook ï¼Œ")]),s._v(" "),n("p",[s._v("é…ç½® "),n("code",[s._v("cron")]),s._v(" ä½œä¸šï¼Œè¯¥ä½œä¸š"),n("code",[s._v("æ¯éš” 2 åˆ†é’Ÿ")]),s._v("è¿è¡Œå¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š")]),s._v(" "),n("p",[n("code",[s._v('logger "EX294 in progress"')]),s._v("ï¼Œä»¥ç”¨æˆ· "),n("code",[s._v("natasha")]),s._v(" èº«ä»½è¿è¡Œ")])]),s._v(" "),n("p",[s._v("è§£é¢˜æ–¹æ³•ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('[greg@bastion ansible]$ vim cron.yml\n---\n- name: é…ç½® cron ä½œä¸š\n  hosts: all\n  tasks:\n          - name: one\n            user:\n                    name: natasha\n                    state: present\n          - name: two\n            cron:\n                    name: "logger info"\n                    minute: "*/2"\n                    user: natasha\n                    job: logger "EX294 in progress"\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h2",{attrs:{id:"ç”Ÿæˆç¡¬ä»¶æŠ¥å‘Š"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ç”Ÿæˆç¡¬ä»¶æŠ¥å‘Š"}},[s._v("#")]),s._v(" "),n("strong",[s._v("ç”Ÿæˆç¡¬ä»¶æŠ¥å‘Š")])]),s._v(" "),n("blockquote",[n("p",[s._v("åˆ›å»ºä¸€ä¸ªåä¸º /home/greg/ansible/hwreport.yml çš„ playbook ï¼Œå®ƒå°†åœ¨æ‰€æœ‰å—ç®¡èŠ‚ç‚¹ä¸Šç”Ÿæˆå«æœ‰ä»¥ä¸‹ä¿¡æ¯çš„è¾“å‡ºæ–‡ä»¶ /root/hwreport.txt ï¼š")]),s._v(" "),n("p",[s._v("æ¸…å•ä¸»æœºåç§°")]),s._v(" "),n("p",[s._v("ä»¥ MB è¡¨ç¤ºçš„æ€»å†…å­˜å¤§å°")]),s._v(" "),n("p",[s._v("BIOS ç‰ˆæœ¬")]),s._v(" "),n("p",[s._v("ç£ç›˜è®¾å¤‡ vda çš„å¤§å°")]),s._v(" "),n("p",[s._v("ç£ç›˜è®¾å¤‡ vdb çš„å¤§å°")]),s._v(" "),n("p",[s._v("è¾“å‡ºæ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œå«æœ‰ä¸€ä¸ª key=value å¯¹ã€‚")]),s._v(" "),n("p",[s._v("æ‚¨çš„ playbook åº”å½“ï¼š")]),s._v(" "),n("p",[s._v("ä» http://materials/hwreport.empty ä¸‹è½½æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä¿å­˜ä¸º /root/hwreport.txt")]),s._v(" "),n("p",[s._v("ä½¿ç”¨æ­£ç¡®çš„å€¼æ”¹ä¸º /root/hwreport.txt")]),s._v(" "),n("p",[s._v("å¦‚æœç¡¬ä»¶é¡¹ä¸å­˜åœ¨ï¼Œç›¸å…³çš„å€¼åº”è®¾ä¸º NONE")])]),s._v(" "),n("p",[s._v("è§£é¢˜æ–¹æ³•ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('[greg@bastion ansible]$ vim hwreport.yml\n---\n- name: ç”Ÿæˆç¡¬ä»¶æŠ¥å‘Š\n  hosts: all\n  vars:\n          hw_all:\n                  - hw_name: HOST\n                    hw_cont: "{{ inventory_hostname | default(\'NONE\',true) }}"\n                  - hw_name: MEMORY\n                    hw_cont: "{{ ansible_memtotal_mb | default(\'NONE\',true) }}"\n                  - hw_name: BIOS\n                    hw_cont: "{{ ansible_bios_version | default(\'NONE\',true) }}"\n                  - hw_name: DISK_SIZE_VDA\n                    hw_cont: "{{ ansible_devices.vda.size | default(\'NONE\',true) }}"\n                  - hw_name: DISK_SIZE_VDB\n                    hw_cont: "{{ ansible_devices.vdb.size | default(\'NONE\',true) }}"\n  tasks:\n          - name: one\n            get_url:\n                    url: http://materials/hwreport.empty\n                    dest: /root/hwreport.txt\n          - name: two\n            lineinfile:\n                    path: /root/hwreport.txt\n                    regexp: "^{{ item.hw_name }}"\n                    line: "{{ item.hw_name }}={{ item.hw_cont }}"\n            loop: "{{ hw_all }}"\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('ansible dev -m setup -a "filter=*devices*"\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"åˆ›å»ºå¯†ç åº“"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºå¯†ç åº“"}},[s._v("#")]),s._v(" "),n("strong",[s._v("åˆ›å»ºå¯†ç åº“")])]),s._v(" "),n("blockquote",[n("p",[s._v("æŒ‰ç…§ä¸‹æ–¹æ‰€è¿°ï¼Œåˆ›å»ºä¸€ä¸ª Ansible åº“æ¥å­˜å‚¨ç”¨æˆ·å¯†ç ï¼š")]),s._v(" "),n("p",[s._v("åº“åç§°ä¸º /home/greg/ansible/locker.yml")]),s._v(" "),n("p",[s._v("åº“ä¸­å«æœ‰ä¸¤ä¸ªå˜é‡ï¼Œåç§°å¦‚ä¸‹ï¼š")]),s._v(" "),n("p",[s._v("pw_developerï¼Œå€¼ä¸º Imadev")]),s._v(" "),n("p",[s._v("pw_managerï¼Œå€¼ä¸º Imamgr")]),s._v(" "),n("p",[s._v("ç”¨äºåŠ å¯†å’Œè§£å¯†è¯¥åº“çš„å¯†ç ä¸º whenyouwishuponastar")]),s._v(" "),n("p",[s._v("å¯†ç å­˜å‚¨åœ¨æ–‡ä»¶ /home/greg/ansible/secret.txt ä¸­")])]),s._v(" "),n("p",[s._v("è§£é¢˜æ–¹æ³•ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[greg@bastion ansible]$ vim ansible.cfg\n#ä»…ä¿®æ”¹ä¸€è¡Œ\nvault_password_file = /home/greg/ansible/secret.txt\n[greg@bastion ansible]$ vim locker.yml\n---\npw_developer: Imadev\npw_manager: Imamgr\n[greg@bastion ansible]$ echo whenyouwishuponastar > secret.txt\n[greg@bastion ansible]$ ansible-vault encrypt locker.yml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h2",{attrs:{id:"åˆ›å»ºç”¨æˆ·å¸æˆ·"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºç”¨æˆ·å¸æˆ·"}},[s._v("#")]),s._v(" "),n("strong",[s._v("åˆ›å»ºç”¨æˆ·å¸æˆ·")])]),s._v(" "),n("blockquote",[n("p",[s._v("ä» http://materials/user_list.yml ä¸‹è½½è¦åˆ›å»ºçš„ç”¨æˆ·çš„åˆ—è¡¨ï¼Œå¹¶å°†å®ƒä¿å­˜åˆ° /home/greg/ansible")]),s._v(" "),n("p",[s._v("åœ¨æœ¬æ¬¡è€ƒè¯•ä¸­ä½¿ç”¨åœ¨å…¶ä»–ä½ç½®åˆ›å»ºçš„å¯†ç åº“ /home/greg/ansible/locker.yml ã€‚åˆ›å»º/home/greg/ansible/users.yml çš„ playbook ï¼Œä»è€ŒæŒ‰ä»¥ä¸‹æ‰€è¿°åˆ›å»ºç”¨æˆ·å¸æˆ·ï¼š")]),s._v(" "),n("p",[s._v("èŒä½æè¿°ä¸º developer çš„ç”¨æˆ·åº”å½“ï¼š")]),s._v(" "),n("p",[s._v("åœ¨ dev å’Œ test ä¸»æœºç»„ä¸­çš„å—ç®¡èŠ‚ç‚¹ä¸Šåˆ›å»º")]),s._v(" "),n("p",[s._v("ä» pw_developer å˜é‡åˆ†é…å¯†ç ")]),s._v(" "),n("p",[s._v("é…ç½®ç”¨æˆ·uid")]),s._v(" "),n("p",[s._v("æ˜¯è¡¥å……ç»„ devops çš„æˆå‘˜")]),s._v(" "),n("p",[s._v("èŒä½æè¿°ä¸º manager çš„ç”¨æˆ·åº”å½“ï¼š")]),s._v(" "),n("p",[s._v("åœ¨ prod ä¸»æœºç»„ä¸­çš„å—ç®¡èŠ‚ç‚¹ä¸Šåˆ›å»º")]),s._v(" "),n("p",[s._v("ä» pw_manager å˜é‡åˆ†é…å¯†ç ")]),s._v(" "),n("p",[s._v("é…ç½®ç”¨æˆ·uid")]),s._v(" "),n("p",[s._v("æ˜¯è¡¥å……ç»„ opsmgr çš„æˆå‘˜")]),s._v(" "),n("p",[s._v("å¯†ç é‡‡ç”¨ SHA512 å“ˆå¸Œæ ¼å¼ã€‚")]),s._v(" "),n("p",[s._v("æ‚¨çš„ playbook åº”èƒ½å¤Ÿåœ¨æœ¬æ¬¡è€ƒè¯•ä¸­ä½¿ç”¨åœ¨å…¶ä»–ä½ç½®åˆ›å»ºçš„åº“å¯†ç æ–‡ä»¶ /home/greg/ansible/secret.txt æ­£å¸¸è¿è¡Œã€‚")])]),s._v(" "),n("p",[s._v("è§£é¢˜æ–¹æ³•ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('[greg@bastion ansible]$ wget http://materials/user_list.yml\n[greg@bastion ansible]$ vim users.yml\n---\n- name: create user\n  hosts: all\n  vars_files:\n          - /home/greg/ansible/user_list.yml\n          - /home/greg/ansible/locker.yml\n  tasks:\n          - name: create devops\n            group:\n                    name: devops\n                    state: present\n            when: item.job == \'developer\' and (inventory_hostname in groups.dev or inventory_hostname in groups.test)\n            loop: "{{ users }}"\n\n          - name: create users\n            user:\n                    name: "{{ item.name }}"\n                    uid: "{{ item.uid }}"\n                    groups: devops\n                    password: "{{ pw_developer | password_hash(\'sha512\',\'mysecretsalt\') }}"\n            when: item.job == \'developer\' and (inventory_hostname in groups.dev or inventory_hostname in groups.test)\n            loop: "{{ users }}"\n          - name: create opsmgr\n            group:\n                    name: opsmgr\n                    state: present\n            when: item.job == \'manager\' and inventory_hostname in groups.prod\n            loop: "{{ users }}"\n\n          - name: create users\n            user:\n                    name: "{{ item.name }}"\n                    uid: "{{ item.uid }}"\n                    groups: opsmgr\n                    password: "{{ pw_manager | password_hash(\'sha512\',\'mysecretsalt\') }}"\n            when: item.job == \'manager\' and inventory_hostname in groups.prod\n            loop: "{{ users}}"\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br")])]),n("h2",{attrs:{id:"æ›´æ–°-ansible-åº“çš„å¯†é’¥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ›´æ–°-ansible-åº“çš„å¯†é’¥"}},[s._v("#")]),s._v(" "),n("strong",[s._v("æ›´æ–° Ansible åº“çš„å¯†é’¥")])]),s._v(" "),n("blockquote",[n("p",[s._v("æŒ‰ç…§ä¸‹æ–¹æ‰€è¿°ï¼Œæ›´æ–°ç°æœ‰ Ansible åº“çš„å¯†é’¥ï¼š")]),s._v(" "),n("p",[s._v("ä» http://materials/salaries.yml ä¸‹è½½ Ansible åº“åˆ° /home/greg/ansible")]),s._v(" "),n("p",[s._v("å½“å‰çš„åº“å¯†ç ä¸º insecure8sure")]),s._v(" "),n("p",[s._v("æ–°çš„åº“å¯†ç ä¸º bbs2you9527")]),s._v(" "),n("p",[s._v("åº“ä½¿ç”¨æ–°å¯†ç ä¿æŒåŠ å¯†çŠ¶æ€")])]),s._v(" "),n("p",[s._v("è§£é¢˜æ–¹æ³•ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("[greg@bastion ansible]$ wget http://materials/salaries.yml\n[greg@bastion ansible]$ ansible-vault rekey --ask-vault-pass salaries.yml\nVault password: ç²˜è´´å½“å‰å¯†ç \nNew Vault password: ç²˜è´´æ–°å¯†ç \nConfirm New Vault password: ç²˜è´´æ–°å¯†ç \n[greg@bastion ansible]$ ansible-vault view salaries.yml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h2",{attrs:{id:"åˆ›å»ºåˆ†åŒº-éšè—é¢˜ã€æœ‰æ¦‚ç‡å‡ºç°"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºåˆ†åŒº-éšè—é¢˜ã€æœ‰æ¦‚ç‡å‡ºç°"}},[s._v("#")]),s._v(" "),n("strong",[s._v("åˆ›å»ºåˆ†åŒºï¼ˆéšè—é¢˜ã€æœ‰æ¦‚ç‡å‡ºç°ï¼‰")])]),s._v(" "),n("blockquote",[n("p",[s._v("åœ¨balancersä¸»æœºä¸Šï¼Œåˆ’åˆ†æ–°çš„åˆ†åŒºï¼Œè®¾å¤‡ä¸º/dev/vddï¼Œç¼–å·1ï¼Œå¤§å°1500mï¼Œæ ¼å¼åŒ–æˆext4ï¼Œmountåˆ°/newpart1ç›®å½•ï¼Œå¦‚æœç©ºé—´ä¸å¤Ÿï¼Œåˆ†800mï¼Œå¦‚æœæ²¡æœ‰vddï¼ŒæŠ¥é”™")])]),s._v(" "),n("p",[s._v("è§£é¢˜æ–¹æ³•ï¼š")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("---\n- name: åˆ›å»ºåˆ†åŒº\n  hosts: balancers\n  tasks:\n          - block:\n                  - name: one\n                    file:\n                            path: /newpart1\n                            state: directory\n                  - name: two\n                    parted:\n                            device: /dev/vdd\n                            number: 1\n                            state: present\n                            part_end: 1500MiB\n                  - name: three\n                    filesystem:\n                            fstype: ext4\n                            dev: /dev/vdd1\n                  - name: four\n                    mount:\n                            path: /newpart1\n                            src: /dev/vdd1\n                            fstype: ext4\n                            state: mounted\n            rescue:\n                    - debug:\n                            msg: Could not create partation of that size\n                    - name: five\n                      parted:\n                              device: /dev/vdd\n                              number: 1\n                              state: present\n                              part_end: 800MiB\n                      when: ansible_facts.devices.vdd is defined\n                    - name: six\n                      filesystem:\n                              fstype: ext4\n                              dev: /dev/vdd1\n                      when: ansible_facts.devices.vdd is defined\n                    - name: seven\n                      mount:\n                              path: /newpart1\n                              src: /dev/vdd1\n                              fstype: ext4\n                              state: mounted\n                      when: ansible_facts.devices.vdd is defined\n                    - debug:\n                            msg: Disk does not exist\n                      when: ansible_facts.devices.vdd is undefined\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br")])]),n("h2",{attrs:{id:"å®‰è£…rhelè§’è‰²-éšè—é¢˜ã€æœ‰æ¦‚ç‡å‡ºç°"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…rhelè§’è‰²-éšè—é¢˜ã€æœ‰æ¦‚ç‡å‡ºç°"}},[s._v("#")]),s._v(" "),n("strong",[s._v("å®‰è£…RHELè§’è‰²ï¼ˆéšè—é¢˜ã€æœ‰æ¦‚ç‡å‡ºç°ï¼‰")])]),s._v(" "),n("blockquote",[n("p",[s._v("å®‰è£…RHELè§’è‰²ï¼Œå¹¶ä½¿ç”¨SELinuxè§’è‰²ï¼Œè¦æ±‚åœ¨æ‰€æœ‰èŠ‚ç‚¹è¿è¡Œï¼Œå°†SELinuxè®¾ç½®ä¸ºå¼ºåˆ¶æ¨¡å¼ã€‚")])]),s._v(" "),n("p",[n("strong",[s._v("è§£é¢˜æ–¹æ³•ï¼š")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# å¦‚æœç¬¬4é¢˜ä¸åšçš„è¯ä¸‹é¢æ­¥éª¤å¯èƒ½ä¼šæŠ¥é”™ï¼Œæ‰€æœ‰ä¸åšç¬¬4é¢˜éœ€è¦æ‰§è¡Œä»¥ä¸‹æ“ä½œ\n[greg@bastion ansible]$ sudo yum install rhel-system-roles\n[greg@bastion ansible]$ vim ansible.cfg\n#ä»…ä¿®æ”¹ä¸€è¡Œ\nroles_path = /home/greg/ansible/roles:/usr/share/ansible/roles\n[greg@bastion ansible]$ ansible-galaxy list\n# å¦‚æœç¬¬4é¢˜åšçš„è¯å¯ä»¥ä¸ç”¨æ‰§è¡Œä¸Šé¢æ“ä½œ\n[greg@bastion ansible]$ cp -rf /usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml ./\n[greg@bastion ansible]$ vim selinux.yml\n#å®‰è£…å‡ºæ¥åå¯ä»¥æ”¹ä¹Ÿå¯ä»¥ä¸æ”¹ï¼Œæ”¹çš„è¯å°±å‰©ä¸‹è¿™äº›å°±å¯ä»¥ï¼Œå¤šä½™çš„åˆ é™¤ã€‚\n---\n- hosts: all\n  vars:\n          selinux_policy: targeted\n          selinux_state: enforcing\n  roles:\n    - role: roles/rhel-system-roles.selinux\n  tasks:\n          - name: apply SElinux role\n            block:\n                    - include_roles:\n                            name: roles/rhel-system-roles.selinux\n            rescue:\n                    - name: check\n                      fail:\n                      when: not selinux_reboot_required\n                    - name: reboot\n                      reboot:\n                    - name: changed\n                      include_role:\n                        name: roles/rhel-system-roles.selinux\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);