<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RHCE学习笔记 | Howietron</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <noscript><meta http-equiv="refresh" content="0; url=https://www.youngkbt.cn/noscript/"><style>.theme-vdoing-content { display:none }</noscript>
    <meta name="description" content="web前端技术博客,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,React,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="个人技术博客，前端、后端和运维相关,技术文档,学习,面试。。。">
    <meta name="theme-color" content="#11a8cd">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <link rel="preload" href="/assets/css/0.styles.463a9fc9.css" as="style"><link rel="preload" href="/assets/js/app.1d50e76c.js" as="script"><link rel="preload" href="/assets/js/2.b0099ba6.js" as="script"><link rel="preload" href="/assets/js/82.b30db31d.js" as="script"><link rel="preload" href="/assets/js/3.169f32b5.js" as="script"><link rel="preload" href="/assets/js/4.62a224c4.js" as="script"><link rel="prefetch" href="/assets/js/10.a7391f8b.js"><link rel="prefetch" href="/assets/js/100.79269a0b.js"><link rel="prefetch" href="/assets/js/101.3083aabb.js"><link rel="prefetch" href="/assets/js/102.50fcaec8.js"><link rel="prefetch" href="/assets/js/103.9be01f36.js"><link rel="prefetch" href="/assets/js/104.27864278.js"><link rel="prefetch" href="/assets/js/105.906d80e6.js"><link rel="prefetch" href="/assets/js/106.587aca9d.js"><link rel="prefetch" href="/assets/js/107.a5e44fe1.js"><link rel="prefetch" href="/assets/js/108.0379b97f.js"><link rel="prefetch" href="/assets/js/109.2595049f.js"><link rel="prefetch" href="/assets/js/11.27e79569.js"><link rel="prefetch" href="/assets/js/110.f9df9e77.js"><link rel="prefetch" href="/assets/js/111.76c68355.js"><link rel="prefetch" href="/assets/js/112.066039ad.js"><link rel="prefetch" href="/assets/js/113.f7015ac6.js"><link rel="prefetch" href="/assets/js/114.859338e9.js"><link rel="prefetch" href="/assets/js/115.b0aaffdc.js"><link rel="prefetch" href="/assets/js/116.c19eb2fe.js"><link rel="prefetch" href="/assets/js/117.9ee780b1.js"><link rel="prefetch" href="/assets/js/118.59aa8343.js"><link rel="prefetch" href="/assets/js/119.66fb9ed0.js"><link rel="prefetch" href="/assets/js/12.cdd22924.js"><link rel="prefetch" href="/assets/js/120.213475e2.js"><link rel="prefetch" href="/assets/js/121.c169d995.js"><link rel="prefetch" href="/assets/js/122.2ed17156.js"><link rel="prefetch" href="/assets/js/123.2632697a.js"><link rel="prefetch" href="/assets/js/124.06a3e7e3.js"><link rel="prefetch" href="/assets/js/13.8694af16.js"><link rel="prefetch" href="/assets/js/14.19c81616.js"><link rel="prefetch" href="/assets/js/15.d851f6ce.js"><link rel="prefetch" href="/assets/js/16.2a97c501.js"><link rel="prefetch" href="/assets/js/17.ec0e807e.js"><link rel="prefetch" href="/assets/js/18.097de9bb.js"><link rel="prefetch" href="/assets/js/19.06401dbb.js"><link rel="prefetch" href="/assets/js/20.e75809dd.js"><link rel="prefetch" href="/assets/js/21.8f6d252f.js"><link rel="prefetch" href="/assets/js/22.73df95ed.js"><link rel="prefetch" href="/assets/js/23.15dfea8a.js"><link rel="prefetch" href="/assets/js/24.88d01981.js"><link rel="prefetch" href="/assets/js/25.88d97ce4.js"><link rel="prefetch" href="/assets/js/26.9e6b05f7.js"><link rel="prefetch" href="/assets/js/27.07481455.js"><link rel="prefetch" href="/assets/js/28.2c267bb5.js"><link rel="prefetch" href="/assets/js/29.9d9ca1a0.js"><link rel="prefetch" href="/assets/js/30.0fb0cea3.js"><link rel="prefetch" href="/assets/js/31.552320f3.js"><link rel="prefetch" href="/assets/js/32.c92a5fa6.js"><link rel="prefetch" href="/assets/js/33.eda8c34e.js"><link rel="prefetch" href="/assets/js/34.5df973f8.js"><link rel="prefetch" href="/assets/js/35.935c0d5a.js"><link rel="prefetch" href="/assets/js/36.8d61edfd.js"><link rel="prefetch" href="/assets/js/37.7eca0a7e.js"><link rel="prefetch" href="/assets/js/38.3562c9bf.js"><link rel="prefetch" href="/assets/js/39.2ee318e6.js"><link rel="prefetch" href="/assets/js/40.f3935071.js"><link rel="prefetch" href="/assets/js/41.694dbcf4.js"><link rel="prefetch" href="/assets/js/42.d097521b.js"><link rel="prefetch" href="/assets/js/43.b9e74104.js"><link rel="prefetch" href="/assets/js/44.1eb8e26f.js"><link rel="prefetch" href="/assets/js/45.7502149c.js"><link rel="prefetch" href="/assets/js/46.b67e9815.js"><link rel="prefetch" href="/assets/js/47.ba898179.js"><link rel="prefetch" href="/assets/js/48.9479db95.js"><link rel="prefetch" href="/assets/js/49.ec05f4df.js"><link rel="prefetch" href="/assets/js/5.9e732329.js"><link rel="prefetch" href="/assets/js/50.5f944160.js"><link rel="prefetch" href="/assets/js/51.e1e94020.js"><link rel="prefetch" href="/assets/js/52.ec15bfcb.js"><link rel="prefetch" href="/assets/js/53.85fb02ad.js"><link rel="prefetch" href="/assets/js/54.8b5812cb.js"><link rel="prefetch" href="/assets/js/55.22841d47.js"><link rel="prefetch" href="/assets/js/56.15eda577.js"><link rel="prefetch" href="/assets/js/57.8045be4f.js"><link rel="prefetch" href="/assets/js/58.8f8b3fc3.js"><link rel="prefetch" href="/assets/js/59.02a58390.js"><link rel="prefetch" href="/assets/js/6.e4fd9bdc.js"><link rel="prefetch" href="/assets/js/60.83da9ee4.js"><link rel="prefetch" href="/assets/js/61.1c22c3bf.js"><link rel="prefetch" href="/assets/js/62.c918ad66.js"><link rel="prefetch" href="/assets/js/63.7d2682ca.js"><link rel="prefetch" href="/assets/js/64.d01e4ef7.js"><link rel="prefetch" href="/assets/js/65.a33fe739.js"><link rel="prefetch" href="/assets/js/66.bac598f3.js"><link rel="prefetch" href="/assets/js/67.96ae0cf1.js"><link rel="prefetch" href="/assets/js/68.16ed6024.js"><link rel="prefetch" href="/assets/js/69.7f0d8afc.js"><link rel="prefetch" href="/assets/js/7.eeee2c82.js"><link rel="prefetch" href="/assets/js/70.0d62e753.js"><link rel="prefetch" href="/assets/js/71.addb0e78.js"><link rel="prefetch" href="/assets/js/72.df5ea9e8.js"><link rel="prefetch" href="/assets/js/73.73f2994e.js"><link rel="prefetch" href="/assets/js/74.7469d361.js"><link rel="prefetch" href="/assets/js/75.4032252b.js"><link rel="prefetch" href="/assets/js/76.f22af2fb.js"><link rel="prefetch" href="/assets/js/77.6aa5e35f.js"><link rel="prefetch" href="/assets/js/78.9f5ba56e.js"><link rel="prefetch" href="/assets/js/79.6ea04488.js"><link rel="prefetch" href="/assets/js/8.4c95d018.js"><link rel="prefetch" href="/assets/js/80.4ef64692.js"><link rel="prefetch" href="/assets/js/81.a2e1ec72.js"><link rel="prefetch" href="/assets/js/83.dba0f389.js"><link rel="prefetch" href="/assets/js/84.5b7d99aa.js"><link rel="prefetch" href="/assets/js/85.c948e508.js"><link rel="prefetch" href="/assets/js/86.b9ee6aff.js"><link rel="prefetch" href="/assets/js/87.2eeea6b8.js"><link rel="prefetch" href="/assets/js/88.bbce2256.js"><link rel="prefetch" href="/assets/js/89.85d58807.js"><link rel="prefetch" href="/assets/js/9.321fdd53.js"><link rel="prefetch" href="/assets/js/90.d14a53d2.js"><link rel="prefetch" href="/assets/js/91.6dc8852d.js"><link rel="prefetch" href="/assets/js/92.4dca5da3.js"><link rel="prefetch" href="/assets/js/93.4cf9c694.js"><link rel="prefetch" href="/assets/js/94.9df5337f.js"><link rel="prefetch" href="/assets/js/95.637b6cc1.js"><link rel="prefetch" href="/assets/js/96.25a5798c.js"><link rel="prefetch" href="/assets/js/97.d6776d2c.js"><link rel="prefetch" href="/assets/js/98.72c0a927.js"><link rel="prefetch" href="/assets/js/99.c6dcfe5c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.463a9fc9.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://cdn.jsdelivr.net/gh/Howietron/Howietron/img/2023/09/1320230913133821.png" alt="Howietron" class="logo"> <span class="site-name can-hide">Howietron</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/a61298/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/server/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/0694db/" class="nav-link">Java核心基础</a></li><li class="dropdown-item"><!----> <a href="/pages/baf2c1/" class="nav-link">Java后端框架</a></li><li class="dropdown-item"><!----> <a href="/pages/d860e2/" class="nav-link">分布式中间件</a></li><li class="dropdown-item"><!----> <a href="/pages/85ae20/" class="nav-link">微服务架构</a></li><li class="dropdown-item"><!----> <a href="/pages/2724aa/" class="nav-link">算法和数据结构</a></li><li class="dropdown-item"><!----> <a href="/pages/659821/" class="nav-link">底层必备源码</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><a href="/devops/" class="link-title">运维</a> <span class="title" style="display:none;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f78d73/" class="nav-link">Linux学习</a></li><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/7e66b5/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/Howietron/Howietron.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/Howietron/Howietron/img/202306031748859.gif"> <div class="blogger-info"><h3>Howietron</h3> <span>放平心态，偷偷厉害。</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/a61298/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/server/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/0694db/" class="nav-link">Java核心基础</a></li><li class="dropdown-item"><!----> <a href="/pages/baf2c1/" class="nav-link">Java后端框架</a></li><li class="dropdown-item"><!----> <a href="/pages/d860e2/" class="nav-link">分布式中间件</a></li><li class="dropdown-item"><!----> <a href="/pages/85ae20/" class="nav-link">微服务架构</a></li><li class="dropdown-item"><!----> <a href="/pages/2724aa/" class="nav-link">算法和数据结构</a></li><li class="dropdown-item"><!----> <a href="/pages/659821/" class="nav-link">底层必备源码</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><a href="/devops/" class="link-title">运维</a> <span class="title" style="display:none;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f78d73/" class="nav-link">Linux学习</a></li><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/7e66b5/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/Howietron/Howietron.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Linux学习</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/f78d73/" class="sidebar-link">Linux学习笔记</a></li><li><a href="/pages/55bab3/" class="sidebar-link">RHCSA学习笔记</a></li><li><a href="/pages/fbbe11/" aria-current="page" class="active sidebar-link">RHCE学习笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#安装和配置-ansible" class="sidebar-link">安装和配置 Ansible</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#创建和运行-ansible-临时命令" class="sidebar-link">创建和运行 Ansible 临时命令</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#安装软件包" class="sidebar-link">安装软件包</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#使用-rhel-系统角色" class="sidebar-link">使用 RHEL 系统角色</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#使用-ansible-galaxy-安装角色" class="sidebar-link">使用 Ansible Galaxy 安装角色</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#创建和使用角色" class="sidebar-link">创建和使用角色</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#从-ansible-galaxy-使用角色" class="sidebar-link">从 Ansible Galaxy 使用角色</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#创建和使用逻辑卷" class="sidebar-link">创建和使用逻辑卷</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#生成主机文件" class="sidebar-link">生成主机文件</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#修改文件内容" class="sidebar-link">修改文件内容</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#创建-web-内容目录" class="sidebar-link">创建 Web 内容目录</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#配置-cron-作业-新增" class="sidebar-link">配置 cron 作业（新增）</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#生成硬件报告" class="sidebar-link">生成硬件报告</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#创建密码库" class="sidebar-link">创建密码库</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#创建用户帐户" class="sidebar-link">创建用户帐户</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#更新-ansible-库的密钥" class="sidebar-link">更新 Ansible 库的密钥</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#创建分区-隐藏题、有概率出现" class="sidebar-link">创建分区（隐藏题、有概率出现）</a></li><li class="sidebar-sub-header level2"><a href="/pages/fbbe11/#安装rhel角色-隐藏题、有概率出现" class="sidebar-link">安装RHEL角色（隐藏题、有概率出现）</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GitHub技巧</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nodejs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>博客搭建</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>技术文档</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/devops/#运维" data-v-06225672>运维</a></li><li data-v-06225672><a href="/devops/#Linux学习" data-v-06225672>Linux学习</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/Howietron" target="_blank" title="作者" class="beLink" data-v-06225672>Howietron</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-09-12</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">RHCE学习笔记<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="rhce学习笔记"><a href="#rhce学习笔记" class="header-anchor">#</a> RHCE学习笔记</h1> <p><strong>重要配置信息</strong></p> <p>在考试期间，除了您就坐位置的台式机之外，还将使用多个虚拟系统。您不具有台式机系统的 root 访问权，但具有对虚拟系统的完整 root 访问权。</p> <p><strong>系统信息</strong></p> <p>在本考试期间，您将操作下列虚拟系统：</p> <img src="https://cdn.jsdelivr.net/gh/Howietron/Howietron/img/2023/09/1220230912141133.png" alt="img"> <p>这些系统的 IP 地址采用静态设置。请勿更改这些设置。</p> <p>主机名称解析已配置为解析上方列出的完全限定主机名，同时也解析主机短名称。</p> <p><strong>帐户信息</strong></p> <p>所有系统的 root 密码是 flectrag。</p> <p>请勿更改 root 密码。除非另有指定，否则这将是用于访问其他系统和服务的密码。此外，除非另有指定，否则此密码也应用于您创建的所有帐户，或者任何需要设置密码的服务。</p> <p>为方便起见，所有系统上已预装了 SSH 密钥，允许在不输入密码的前提下通过 SSH 进行 root 访问。请勿对系统上的 root SSH 配置文件进行任何修改。</p> <p>Ansible 控制节点上已创建了用户帐户 greg。此帐户预装了 SSH 密钥，允许在 Ansible 控制节点和各个 Ansible 受管节点之间进行 SSH 登录。请勿对系统上的 greg SSH 配置文件进行任何修改。您可以从 root 帐户使用 su 访问此用户帐户。</p> <p><strong>重要信息</strong></p> <blockquote><p>除非另有指定，否则您的所有工作（包括 Ansible playbook、配置文件和主机清单等）应当保存在控制节点上的目录 /home/greg/ansible 中，并且应当归 greg 用户所有。所有 Ansible 相关的命令应当由 greg 用户从 Ansible 控制节点上的这个目录运行。</p></blockquote> <p><strong>其他信息</strong>
一些考试项目可能需要修改 Ansible 主机清单。您要负责确保所有以前的清单组和项目保留下来，与任何其他更改共存。您还要有确保清单中所有默认的组和主机保留您进行的任何更改。</p> <p>考试系统上的防火墙默认为不启用，SELinux 则处于强制模式。</p> <p>如果需要安装其他软件，您的物理系统和 Ansible 控制节点可能已设置为指向 content 上的下述存储库：</p> <blockquote><p>http://content/rhel8.0/x86_64/dvd/BaseOS</p> <p>http://content/rhel8.0/x86_64/dvd/AppStream</p></blockquote> <p>一些项目需要额外的文件，这些文件已在以下位置提供：</p> <blockquote><p>http://materials</p></blockquote> <p>产品文档可从以下位置找到：</p> <p>http://materials/docs/ansible/html</p> <p>其他资源也进行了配置，供您在考试期间使用。关于这些资源的具体信息将在需要这些资源的项目中提供。</p> <p><strong>重要信息</strong></p> <p>请注意，在评分之前，您的 Ansible 受管节点系统将重置为考试开始时的初始状态，您编写的 Ansible playbook 将通过以 greg 用户身份从控制节点上的目录 /home/greg/ansible 目录运行来应用。在 playbook 运行后，系统会对您的受管节点进行评估，以判断它们是否按照规定进行了配置。</p> <h2 id="安装和配置-ansible"><a href="#安装和配置-ansible" class="header-anchor">#</a> <strong>安装和配置 Ansible</strong></h2> <blockquote><p>按照下方所述，在控制节点 172.25.250.254 上安装和配置 Ansible：</p> <p>安装所需的软件包</p> <p>创建名为 /home/greg/ansible/inventory 的静态清单文件，以满足以下要求：</p> <p>172.25.250.9 是 dev 主机组的成员</p> <p>172.25.250.10 是 test 主机组的成员</p> <p>172.25.250.11 和 172.25.250.12 是 prod 主机组的成员</p> <p>172.25.250.13 是 balancers 主机组的成员</p> <p>prod 组是 webservers 主机组的成员</p> <p>创建名为 /home/greg/ansible/ansible.cfg 的配置文件，以满足以下要求：</p> <p>主机清单文件为 /home/greg/ansible/inventory</p> <p>playbook 中使用的角色的位置包括 /home/greg/ansible/roles</p></blockquote> <p><strong>解题方法：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion ~]$ sudo yum install -y ansible
[greg@bastion ~]$ mkdir -p /home/greg/ansible
[greg@bastion ~]$ cd /home/greg/ansible
[greg@bastion ansible]$ vim inventory
[dev]
172.25.250.9
[test]
172.25.250.10
[prod]
172.25.250.11
172.25.250.12
[balancers]
172.25.250.13
[webservers:children]
prod
[all:vars]
ansible_user=root
ansible_password=redhat
[greg@bastion ansible]$ cp /etc/ansible/ansible.cfg ./
[greg@bastion ansible]$ mkdir roles
[greg@bastion ansible]$ vim /home/greg/ansible/ansible.cfg
#总共只修改四行
inventory = /home/greg/ansible/inventory
roles_path = /home/greg/ansible/roles
host_key_checking = False				 # 68行
remote_user = root                       # 107行
[greg@bastion ansible]$ ansible --version
[greg@bastion ansible]$ ansible-inventory --graph
[greg@bastion ansible]$ ansible all -m ping # 看配置文件是否生效
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="创建和运行-ansible-临时命令"><a href="#创建和运行-ansible-临时命令" class="header-anchor">#</a> <strong>创建和运行 Ansible 临时命令</strong></h2> <blockquote><p>作为系统管理员，您需要在受管节点上安装软件。</p> <p>请按照正文所述，创建一个名为 /home/greg/ansible/adhoc.sh 的 shell 脚本，该脚本将使用 Ansible 临时命令在各个受管节点上安装 yum 存储库：</p> <p>存储库1：</p> <p>存储库的名称为 EX294_BASE</p> <p>描述为 EX294 base software</p> <p>基础 URL 为 http://content/rhel8.0/x86_64/dvd/BaseOS</p> <p>GPG 签名检查为启用状态</p> <p>GPG 密钥 URL 为 http://content/rhel8.0/x86_64/dvd/RPM-GPG-KEY-redhat-release</p> <p>存储库为启用状态</p> <p>存储库2：</p> <p>存储库的名称为 EX294_STREAM</p> <p>描述为 EX294 stream software</p> <p>基础 URL 为 http://content/rhel8.0/x86_64/dvd/AppStream</p> <p>GPG 签名检查为启用状态</p> <p>GPG 密钥 URL 为 http://content/rhel8.0/x86_64/dvd/RPM-GPG-KEY-redhat-release</p> <p>存储库为启用状态</p></blockquote> <p><strong>解题方法：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion ansible]$ ansible-doc yum_repository
[greg@bastion ansible]$ vim adhoc.sh
#!/bin/bash
ansible all -m yum_repository -a 'name=&quot;EX294_BASE&quot; description=&quot;EX294 base software&quot; baseurl=&quot;http://content/rhel8.0/x86_64/dvd/BaseOS&quot; gpgcheck=yes enabled=1 gpgkey=&quot;http://content/rhel8.0/x86_64/dvd/RPM-GPG-KEY-redhat-release&quot;'
ansible all -m yum_repository -a 'name=&quot;EX294_STREAM&quot; description=&quot;EX294 stream software&quot; baseurl=&quot;http://content/rhel8.0/x86_64/dvd/AppStream&quot; gpgcheck=yes enabled=1 gpgkey=&quot;http://content/rhel8.0/x86_64/dvd/RPM-GPG-KEY-redhat-release&quot;'
[greg@bastion ansible]$ chmod +x adhoc.sh
[greg@bastion ansible]$ ./adhoc.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>验证</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ansible dev,test,prod -m shell -a &quot;rpm -qa | grep -Ei 'php|ariadb'&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="安装软件包"><a href="#安装软件包" class="header-anchor">#</a> <strong>安装软件包</strong></h2> <blockquote><p>创建一个名为 /home/greg/ansible/packages.yml 的 playbook :</p> <p>将 php 和 mariadb 软件包安装到 dev、test 和 prod 主机组中的主机上</p> <p>将 RPM Development Tools 软件包组安装到 dev 主机组中的主机上</p> <p>将 dev 主机组中主机上的所有软件包更新为最新版本</p></blockquote> <p><strong>解题方法：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>
---
- name: 安装软件包A
  hosts: dev,test,prod
  tasks:
          - name: one
            yum:
                    name: php
                    state: latest
          - name: two
            yum:
                    name: mariadb
                    state: latest
- name: 安装软件包B
  hosts: dev
  tasks:
          - name: one
            yum:
                    name: &quot;@RPM Development Tools&quot;
                    state: latest
          - name: two
            yum:
                    name: &quot;*&quot;
                    state: latest
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="使用-rhel-系统角色"><a href="#使用-rhel-系统角色" class="header-anchor">#</a> <strong>使用 RHEL 系统角色</strong></h2> <p><strong>😀使用 RHEL 系统角色</strong></p> <blockquote><p>安装 RHEL 系统角色软件包，并创建符合以下条件的 playbook /home/greg/ansible/timesync.yml ：</p> <p>在所有受管节点上运行</p> <p>使用 timesync 角色</p> <p>配置该角色，以使用当前有效的 NTP 提供商</p> <p>配置该角色，以使用时间服务器 172.25.254.254</p> <p>配置该角色，以启用 iburst 参数</p></blockquote> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span>greg@bastion ansible<span class="token punctuation">]</span>$ <span class="token function">sudo</span> yum <span class="token function">install</span> rhel-system-roles
<span class="token punctuation">[</span>greg@bastion ansible<span class="token punctuation">]</span>$ <span class="token function">vim</span> ansible.cfg
<span class="token comment">#仅修改一行</span>
roles_path <span class="token operator">=</span> /home/greg/ansible/roles:/usr/share/ansible/roles
<span class="token punctuation">[</span>greg@bastion ansible<span class="token punctuation">]</span>$ ansible-galaxy list
<span class="token punctuation">[</span>greg@bastion ansible<span class="token punctuation">]</span>$ <span class="token function">cp</span> /usr/share/doc/rhel-system-roles/timesync/example-timesync-playbook.yml timesync.yml
<span class="token punctuation">[</span>greg@bastion ansible<span class="token punctuation">]</span>$ <span class="token function">vim</span> timesync.yml
---
- hosts: all
  vars:
    timesync_ntp_servers:
      - hostname: <span class="token number">172.25</span>.254.254
        iburst: <span class="token function">yes</span>
  roles:
    - rhel-system-roles.timesync
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>验证</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ansible all -m shell -a 'cat /etc/chrony.conf'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="使用-ansible-galaxy-安装角色"><a href="#使用-ansible-galaxy-安装角色" class="header-anchor">#</a> <strong>使用 Ansible Galaxy 安装角色</strong></h2> <blockquote><p>使用 Ansible Galaxy 和要求文件 /home/greg/ansible/roles/requirements.yml 。从以下 URL 下载角色并安装到 /home/greg/ansible/roles ：</p> <p>http://materials/haproxy.tar 此角色的名称应当为 balancer</p> <p>http://materials/phpinfo.tar 此角色的名称应当为 phpinfo</p></blockquote> <p><strong>解题方法：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion ansible]$ mkdir roles
[greg@bastion ansible]$ vim roles/requirements.yml
---
- src: http://materials/haproxy.tar
  name: balancer
- src: http://materials/phpinfo.tar
  name: phpinfo
[greg@bastion ansible]$ ansible-galaxy install -r requirements.yml
[greg@bastion ansible]$ ansible-galaxy list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>注意 ansible-galaxy install -r需要执行两遍，否则判分可能没分</p> <img src="https://cdn.jsdelivr.net/gh/Howietron/Howietron/img/2023/09/1220230912141253.png" alt="image-20230902235326442"> <h2 id="创建和使用角色"><a href="#创建和使用角色" class="header-anchor">#</a> <strong>创建和使用角色</strong></h2> <blockquote><p>根据下列要求，在 /home/greg/ansible/roles 中创建名为 apache 的角色：</p> <p>httpd 软件包已安装，设为在系统启动时启用并启动</p> <p>防火墙已启用并正在运行，并使用允许访问 Web 服务器的规则</p> <p>模板文件 index.html.j2 已存在，用于创建具有以下输出的文件 /var/www/html/index.html ：</p> <p>Welcome to HOSTNAME on IPADDRESS</p> <p>其中，HOSTNAME 是受管节点的完全限定域名，IPADDRESS 则是受管节点的 IP 地址。</p></blockquote> <p>**注意：**角色创建出来就可以了，无需单独进行调用测试、一旦调用使用后反而会导致下面题目报错，下面那道题马上会调用apache角色，按照网页内容及步骤操作即可~</p> <p>解题方法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion roles]$ ansible-galaxy init apache
[greg@bastion roles]$ vim apache/tasks/main.yml
---
- name: add httpd
  yum:
          name: httpd
          state: latest
- name: start httpd
  service:
          name: httpd
          state: started
          enabled: yes
          
- name: start firewalld
  service:
          name: firewalld
          state: started
          enabled: yes         
- name: on http
  firewalld:
          service: http		 # 服务名称
          permanent: yes	 # 重启后生效
          state: enabled     # 开启
          immediate: yes	 # 是否立即应用
- name: create index
  template:
          src: index.html.j2
          dest: /var/www/html/index.html
[greg@bastion roles]$ vim apache/templates/index.html.j2
Welcome to {{ ansible_fqdn }} on {{ ansible_default_ipv4.address }}


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>技巧：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ansible dev -m setup -a 'filter=&quot;ipv4&quot;'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="从-ansible-galaxy-使用角色"><a href="#从-ansible-galaxy-使用角色" class="header-anchor">#</a> <strong>从 Ansible Galaxy 使用角色</strong></h2> <blockquote><p>根据下列要求，创建一个名为 /home/greg/ansible/roles.yml 的 playbook ：</p> <p>playbook 中包含一个 play， 该 play 在 balancers 主机组中的主机上运行并将使用 balancer 角色。</p> <p>此角色配置一项服务，以在 webservers 主机组中的主机之间平衡 Web 服务器请求的负载。</p> <p>浏览到 balancers 主机组中的主机（例如 http://172.25.250.13 ）将生成以下输出：</p> <p>Welcom to serverb.lab.example.com on 172.25.250.11</p> <p>重新加载浏览器将从另一 Web 服务器生成输出：</p> <p>Welcom to serverc.lab.example.com on 172.25.250.12</p> <p>playbook 中包含一个 play， 该 play 在 webservers 主机组中的主机上运行并将使用 phpinfo 角色。</p> <p>请通过 URL /hello.php 浏览到 webservers 主机组中的主机将生成以下输出：</p> <p>Hello PHP World from FQDN</p> <p>其中，FQDN 是主机的完全限定名称。</p> <p>Hello PHP World from</p> <p>serverb.lab.example.com</p> <p>另外还有 PHP 配置的各种详细信息，如安装的 PHP 版本等。</p> <p>同样，浏览到 http://172.25.250.12/hello.php 会生成以下输出：</p> <p>Hello PHP World from</p> <p>serverc.lab.example.com</p> <p>另外还有 PHP 配置的各种详细信息，如安装的 PHP 版本等。</p></blockquote> <p>解题方法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion ansible]$ vim roles.yml
---
- name: one	  # 考试时，该项需要放最后，否则剧本执行报错
  hosts: balancers
  roles:
          - balancer
- name: two
  hosts: webservers
  roles:
          - phpinfo
- name: three
  hosts: webservers   # 页面测试是做负载均衡时页面刷新负载切换比较慢（刷新页面不像模拟环境那么快）
  roles:
          - apache
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="创建和使用逻辑卷"><a href="#创建和使用逻辑卷" class="header-anchor">#</a> <strong>创建和使用逻辑卷</strong></h2> <blockquote><p>创建一个名为 /home/greg/ansible/lv.yml 的 playbook ，它将在所有受管节点上运行以执行下列任务：</p> <p>创建符合以下要求的逻辑卷：</p> <p>逻辑卷创建在 research 卷组中</p> <p>逻辑卷名称为 data</p> <p>逻辑卷大小为 1500 MiB</p> <p>使用 ext4 文件系统格式化逻辑卷</p> <p>如果无法创建请求的逻辑卷大小，应显示错误信息</p> <p>Could not create logical volume of that size</p> <p>，并且应改为使用大小 800 MiB。</p> <p>如果卷组 research 不存在，应显示错误信息</p> <p>Volume group done not exist</p> <p>。</p> <p>不要以任何方式挂载逻辑卷</p></blockquote> <p><strong>解题方法：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion ansible]$ vim lv.yml
---
- name: 创建和使用逻辑卷
  hosts: all
  tasks:
          - block:
                - name: one
                  lvol:
                          vg: research
                          lv: data
                          size: 1500
                - name: two
                  filesystem:
                          fstype: ext4
                          dev: /dev/research/data
            rescue:
                  - name: err msg 1
                    debug:
                          msg: Could not create logical volume of that size
                  - name: three
                    lvol:
                        vg: research
                        lv: data
                        size: 800
                    when: ansible_lvm.vgs.research is defined 
                  - name: err msg 1
                    debug:
                          msg: Volume group done not exist
                    when: ansible_lvm.vgs.research is undefined
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="生成主机文件"><a href="#生成主机文件" class="header-anchor">#</a> <strong>生成主机文件</strong></h2> <blockquote><p>将一个初始模板文件从 http://materials/hosts.j2 下载到 /home/greg/ansible</p> <p>完成该模板，以便用它生成以下文件：针对每个清单主机包含一行内容，其格式与 /etc/hosts 相同</p> <p>创建名为 /home/greg/ansible/hosts.yml 的 playbook ，它将使用此模板在 dev 主机组中的主机上生成文件 /etc/myhosts 。</p> <p>该 playbook 运行后， dev 主机组中主机上的文件 /etc/myhosts 应针对每个受管主机包含一行内容：</p> <p>127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4</p> <p>::1 localhost localhost.localdomain localhost6 localhost6.localdomain6</p> <p>172.25.250.9 workstation.lab.example.com workstation</p> <p>172.25.250.10 servera.lab.example.com servera</p> <p>172.25.250.11 serverb.lab.example.com serverb</p> <p>172.25.250.12 serverc.lab.example.com serverc</p> <p>172.25.250.13 serverd.lab.example.com serverd</p> <p>注：清单主机名称的显示顺序不重要。</p></blockquote> <p>**温馨提示：**目前解题方法A、B没有绝对好坏之分，使用A更简单，但少部分同学反映会被扣分，但目前还不能确定是否为学生考试中自己犯了其他错误导致的。而B方法是红帽原厂标准答案，从理论上更加靠谱，缺点是记忆复杂。请同学们根据自己的备考进度和自身情况进行取舍。</p> <p>解题方法A：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion ansible]$ wget http://materials/hosts.j2
[greg@bastion ansible]$ vim hosts.j2
127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4
::1 localhost localhost.localdomain localhost6 localhost6.localdomain6

172.25.250.9    workstation.lab.example.com      workstation
172.25.250.10   servera.lab.example.com servera
172.25.250.11   serverb.lab.example.com serverb
172.25.250.12   serverc.lab.example.com serverc
172.25.250.13   serverd.lab.example.com serverd
[greg@bastion ansible]$ vim hosts.yml
---
- name: 生成主机文件
  hosts: dev
  tasks:
          - name: one
            template:
                    src: /home/greg/ansible/hosts.j2
                    dest: /etc/myhosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>解题方法B：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion ansible]$ wget http://materials/hosts.j2
[greg@bastion ansible]$ vim hosts.j2
127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4
::1 localhost localhost.localdomain localhost6 localhost6.localdomain
{% for host in groups['all'] %}
{{ hostvars[host]['ansible_facts']['default_ipv4']['address'] }} {{ hostvars[host]['ansible_facts']['fqdn'] }} {{ hostvars[host]['ansible_facts']['hostname'] }}
{% endfor %}
[greg@bastion ansible]$ vim hosts.yml
---
- name: 生成主机文件
  hosts: all
  tasks:
          - name: one
            template:
                    src: /home/greg/ansible/hosts.j2
                    dest: /etc/myhosts
            when: 'inventory_hostname in groups.dev'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="修改文件内容"><a href="#修改文件内容" class="header-anchor">#</a> <strong>修改文件内容</strong></h2> <blockquote><p>按照下方所述，创建一个名为 /home/greg/ansible/issue.yml 的 playbook ：</p> <p>该 playbook 将在所有清单主机上运行</p> <p>该 playbook 会将 /etc/issue 的内容替换为下方所示的一行文本：</p> <p>在 dev 主机组中的主机上，这行文本显示 为：Development</p> <p>在 test 主机组中的主机上，这行文本显示 为：Test</p> <p>在 prod 主机组中的主机上，这行文本显示 为：Production</p></blockquote> <p><strong>解题方法：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion ansible]$ vim issue.yml
---
- name: 修改文件内容
  hosts: all
  tasks:
          - name: one
            copy:
                    content: 'Development'
                    dest: /etc/issue
            when: inventory_hostname in groups.dev
          - name: two
            copy:
                    content: 'Test'
                    dest: /etc/issue
            when: inventory_hostname in groups.test
          - name: three
            copy:
                    content: 'Production'
                    dest: /etc/issue
            when: inventory_hostname in groups.prod
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="创建-web-内容目录"><a href="#创建-web-内容目录" class="header-anchor">#</a> <strong>创建 Web 内容目录</strong></h2> <blockquote><p>按照下方所述，创建一个名为 /home/greg/ansible/webcontent.yml 的 playbook ：</p> <p>该 playbook 在 dev 主机组中的受管节点上运行</p> <p>创建符合下列要求的目录 /webdev ：</p> <p>所有者为 webdev 组</p> <p>具有常规权限：owner=read+write+execute ， group=read+write+execute ，other=read+execute</p> <p>具有特殊权限：设置组 ID</p> <p>用符号链接将 /var/www/html/webdev 链接到 /webdev</p> <p>创建文件 /webdev/index.html ，其中包含如下所示的单行文件： Development</p> <p>在 dev 主机组中主机上浏览此目录（例如 http://172.25.250.9/webdev/ ）将生成以下输出：</p> <p>Development</p></blockquote> <p><strong>解题方法：</strong></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span>greg@bastion ansible<span class="token punctuation">]</span>$ <span class="token function">vim</span> webcontent.yml
---
- name: create web content
  hosts: dev
  tasks:
          - name: create group     <span class="token comment"># 模拟环境需要加这个</span>
            group:
                    name: webdev
                    state: present
          - name: create /webdev
            file:
                    path: /webdev
                    group: webdev
                    mode: <span class="token string">'2775'</span>
                    state: directory
          - name: create <span class="token function">link</span>
            file:
                    src: /webdev
                    dest: /var/www/html/webdev
                    state: <span class="token function">link</span>
          - name: create index.html
            copy:
                    content: <span class="token string">'Development'</span>
                    dest: /webdev/index.html
                    setype: httpd_sys_content_t
          - name: <span class="token function">install</span> httpd
            yum:
                    name: httpd
                    state: latest
          - name: start httpd
            service:
                    name: httpd
                    state: started
                    enabled: <span class="token function">yes</span>
          - name: <span class="token function">open</span> http <span class="token function">service</span> on firewall
            firewalld:
                    service: http
                    state: enabled
                    immediate: <span class="token function">yes</span>
                    permanent: <span class="token function">yes</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h2 id="配置-cron-作业-新增"><a href="#配置-cron-作业-新增" class="header-anchor">#</a> <strong>配置 cron 作业（新增）</strong></h2> <blockquote><p>创建一个名为 /home/greg/ansible/cron.yml 的 playbook ，</p> <p>配置 <code>cron</code> 作业，该作业<code>每隔 2 分钟</code>运行并执行以下命令：</p> <p><code>logger &quot;EX294 in progress&quot;</code>，以用户 <code>natasha</code> 身份运行</p></blockquote> <p>解题方法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion ansible]$ vim cron.yml
---
- name: 配置 cron 作业
  hosts: all
  tasks:
          - name: one
            user:
                    name: natasha
                    state: present
          - name: two
            cron:
                    name: &quot;logger info&quot;
                    minute: &quot;*/2&quot;
                    user: natasha
                    job: logger &quot;EX294 in progress&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="生成硬件报告"><a href="#生成硬件报告" class="header-anchor">#</a> <strong>生成硬件报告</strong></h2> <blockquote><p>创建一个名为 /home/greg/ansible/hwreport.yml 的 playbook ，它将在所有受管节点上生成含有以下信息的输出文件 /root/hwreport.txt ：</p> <p>清单主机名称</p> <p>以 MB 表示的总内存大小</p> <p>BIOS 版本</p> <p>磁盘设备 vda 的大小</p> <p>磁盘设备 vdb 的大小</p> <p>输出文件中的每一行含有一个 key=value 对。</p> <p>您的 playbook 应当：</p> <p>从 http://materials/hwreport.empty 下载文件，并将它保存为 /root/hwreport.txt</p> <p>使用正确的值改为 /root/hwreport.txt</p> <p>如果硬件项不存在，相关的值应设为 NONE</p></blockquote> <p>解题方法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion ansible]$ vim hwreport.yml
---
- name: 生成硬件报告
  hosts: all
  vars:
          hw_all:
                  - hw_name: HOST
                    hw_cont: &quot;{{ inventory_hostname | default('NONE',true) }}&quot;
                  - hw_name: MEMORY
                    hw_cont: &quot;{{ ansible_memtotal_mb | default('NONE',true) }}&quot;
                  - hw_name: BIOS
                    hw_cont: &quot;{{ ansible_bios_version | default('NONE',true) }}&quot;
                  - hw_name: DISK_SIZE_VDA
                    hw_cont: &quot;{{ ansible_devices.vda.size | default('NONE',true) }}&quot;
                  - hw_name: DISK_SIZE_VDB
                    hw_cont: &quot;{{ ansible_devices.vdb.size | default('NONE',true) }}&quot;
  tasks:
          - name: one
            get_url:
                    url: http://materials/hwreport.empty
                    dest: /root/hwreport.txt
          - name: two
            lineinfile:
                    path: /root/hwreport.txt
                    regexp: &quot;^{{ item.hw_name }}&quot;
                    line: &quot;{{ item.hw_name }}={{ item.hw_cont }}&quot;
            loop: &quot;{{ hw_all }}&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>ansible dev -m setup -a &quot;filter=*devices*&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="创建密码库"><a href="#创建密码库" class="header-anchor">#</a> <strong>创建密码库</strong></h2> <blockquote><p>按照下方所述，创建一个 Ansible 库来存储用户密码：</p> <p>库名称为 /home/greg/ansible/locker.yml</p> <p>库中含有两个变量，名称如下：</p> <p>pw_developer，值为 Imadev</p> <p>pw_manager，值为 Imamgr</p> <p>用于加密和解密该库的密码为 whenyouwishuponastar</p> <p>密码存储在文件 /home/greg/ansible/secret.txt 中</p></blockquote> <p>解题方法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion ansible]$ vim ansible.cfg
#仅修改一行
vault_password_file = /home/greg/ansible/secret.txt
[greg@bastion ansible]$ vim locker.yml
---
pw_developer: Imadev
pw_manager: Imamgr
[greg@bastion ansible]$ echo whenyouwishuponastar &gt; secret.txt
[greg@bastion ansible]$ ansible-vault encrypt locker.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="创建用户帐户"><a href="#创建用户帐户" class="header-anchor">#</a> <strong>创建用户帐户</strong></h2> <blockquote><p>从 http://materials/user_list.yml 下载要创建的用户的列表，并将它保存到 /home/greg/ansible</p> <p>在本次考试中使用在其他位置创建的密码库 /home/greg/ansible/locker.yml 。创建/home/greg/ansible/users.yml 的 playbook ，从而按以下所述创建用户帐户：</p> <p>职位描述为 developer 的用户应当：</p> <p>在 dev 和 test 主机组中的受管节点上创建</p> <p>从 pw_developer 变量分配密码</p> <p>配置用户uid</p> <p>是补充组 devops 的成员</p> <p>职位描述为 manager 的用户应当：</p> <p>在 prod 主机组中的受管节点上创建</p> <p>从 pw_manager 变量分配密码</p> <p>配置用户uid</p> <p>是补充组 opsmgr 的成员</p> <p>密码采用 SHA512 哈希格式。</p> <p>您的 playbook 应能够在本次考试中使用在其他位置创建的库密码文件 /home/greg/ansible/secret.txt 正常运行。</p></blockquote> <p>解题方法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion ansible]$ wget http://materials/user_list.yml
[greg@bastion ansible]$ vim users.yml
---
- name: create user
  hosts: all
  vars_files:
          - /home/greg/ansible/user_list.yml
          - /home/greg/ansible/locker.yml
  tasks:
          - name: create devops
            group:
                    name: devops
                    state: present
            when: item.job == 'developer' and (inventory_hostname in groups.dev or inventory_hostname in groups.test)
            loop: &quot;{{ users }}&quot;

          - name: create users
            user:
                    name: &quot;{{ item.name }}&quot;
                    uid: &quot;{{ item.uid }}&quot;
                    groups: devops
                    password: &quot;{{ pw_developer | password_hash('sha512','mysecretsalt') }}&quot;
            when: item.job == 'developer' and (inventory_hostname in groups.dev or inventory_hostname in groups.test)
            loop: &quot;{{ users }}&quot;
          - name: create opsmgr
            group:
                    name: opsmgr
                    state: present
            when: item.job == 'manager' and inventory_hostname in groups.prod
            loop: &quot;{{ users }}&quot;

          - name: create users
            user:
                    name: &quot;{{ item.name }}&quot;
                    uid: &quot;{{ item.uid }}&quot;
                    groups: opsmgr
                    password: &quot;{{ pw_manager | password_hash('sha512','mysecretsalt') }}&quot;
            when: item.job == 'manager' and inventory_hostname in groups.prod
            loop: &quot;{{ users}}&quot;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h2 id="更新-ansible-库的密钥"><a href="#更新-ansible-库的密钥" class="header-anchor">#</a> <strong>更新 Ansible 库的密钥</strong></h2> <blockquote><p>按照下方所述，更新现有 Ansible 库的密钥：</p> <p>从 http://materials/salaries.yml 下载 Ansible 库到 /home/greg/ansible</p> <p>当前的库密码为 insecure8sure</p> <p>新的库密码为 bbs2you9527</p> <p>库使用新密码保持加密状态</p></blockquote> <p>解题方法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[greg@bastion ansible]$ wget http://materials/salaries.yml
[greg@bastion ansible]$ ansible-vault rekey --ask-vault-pass salaries.yml
Vault password: 粘贴当前密码
New Vault password: 粘贴新密码
Confirm New Vault password: 粘贴新密码
[greg@bastion ansible]$ ansible-vault view salaries.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="创建分区-隐藏题、有概率出现"><a href="#创建分区-隐藏题、有概率出现" class="header-anchor">#</a> <strong>创建分区（隐藏题、有概率出现）</strong></h2> <blockquote><p>在balancers主机上，划分新的分区，设备为/dev/vdd，编号1，大小1500m，格式化成ext4，mount到/newpart1目录，如果空间不够，分800m，如果没有vdd，报错</p></blockquote> <p>解题方法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>---
- name: 创建分区
  hosts: balancers
  tasks:
          - block:
                  - name: one
                    file:
                            path: /newpart1
                            state: directory
                  - name: two
                    parted:
                            device: /dev/vdd
                            number: 1
                            state: present
                            part_end: 1500MiB
                  - name: three
                    filesystem:
                            fstype: ext4
                            dev: /dev/vdd1
                  - name: four
                    mount:
                            path: /newpart1
                            src: /dev/vdd1
                            fstype: ext4
                            state: mounted
            rescue:
                    - debug:
                            msg: Could not create partation of that size
                    - name: five
                      parted:
                              device: /dev/vdd
                              number: 1
                              state: present
                              part_end: 800MiB
                      when: ansible_facts.devices.vdd is defined
                    - name: six
                      filesystem:
                              fstype: ext4
                              dev: /dev/vdd1
                      when: ansible_facts.devices.vdd is defined
                    - name: seven
                      mount:
                              path: /newpart1
                              src: /dev/vdd1
                              fstype: ext4
                              state: mounted
                      when: ansible_facts.devices.vdd is defined
                    - debug:
                            msg: Disk does not exist
                      when: ansible_facts.devices.vdd is undefined
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><h2 id="安装rhel角色-隐藏题、有概率出现"><a href="#安装rhel角色-隐藏题、有概率出现" class="header-anchor">#</a> <strong>安装RHEL角色（隐藏题、有概率出现）</strong></h2> <blockquote><p>安装RHEL角色，并使用SELinux角色，要求在所有节点运行，将SELinux设置为强制模式。</p></blockquote> <p><strong>解题方法：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 如果第4题不做的话下面步骤可能会报错，所有不做第4题需要执行以下操作
[greg@bastion ansible]$ sudo yum install rhel-system-roles
[greg@bastion ansible]$ vim ansible.cfg
#仅修改一行
roles_path = /home/greg/ansible/roles:/usr/share/ansible/roles
[greg@bastion ansible]$ ansible-galaxy list
# 如果第4题做的话可以不用执行上面操作
[greg@bastion ansible]$ cp -rf /usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml ./
[greg@bastion ansible]$ vim selinux.yml
#安装出来后可以改也可以不改，改的话就剩下这些就可以，多余的删除。
---
- hosts: all
  vars:
          selinux_policy: targeted
          selinux_state: enforcing
  roles:
    - role: roles/rhel-system-roles.selinux
  tasks:
          - name: apply SElinux role
            block:
                    - include_roles:
                            name: roles/rhel-system-roles.selinux
            rescue:
                    - name: check
                      fail:
                      when: not selinux_reboot_required
                    - name: reboot
                      reboot:
                    - name: changed
                      include_role:
                        name: roles/rhel-system-roles.selinux
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/Howietron/Howietron.github.io/edit/main/docs/03.运维/01.Linux学习/03.RHCE学习笔记.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/09/13, 17:05:54</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/55bab3/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">RHCSA学习笔记</div></a> <a href="/pages/4c778760be26d8b3/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">GitHub高级搜索技巧</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/55bab3/" class="prev">RHCSA学习笔记</a></span> <span class="next"><a href="/pages/4c778760be26d8b3/">GitHub高级搜索技巧</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/f78d73/"><div>
            Linux学习笔记
            <!----></div></a> <span class="date">09-12</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/55bab3/"><div>
            RHCSA学习笔记
            <!----></div></a> <span class="date">09-12</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/45708d/"><div>
            Nginx详细使用及常用配置
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">06-29</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:613872296@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Howietron" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2023
    <span><a href="https://wiki.howie.top" target="_blank">Howietron</a> | <a href="https://beian.miit.gov.cn/#/" target="_blank">鲁ICP备18012116号</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div><div></div><div></div><div></div></div></div>
    <script src="/assets/js/app.1d50e76c.js" defer></script><script src="/assets/js/2.b0099ba6.js" defer></script><script src="/assets/js/82.b30db31d.js" defer></script><script src="/assets/js/3.169f32b5.js" defer></script><script src="/assets/js/4.62a224c4.js" defer></script>
  </body>
</html>
